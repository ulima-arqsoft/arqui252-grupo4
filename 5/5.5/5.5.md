> [5. T√°cticas](../5.md) ‚Ä∫ [5.5. M√≥dulo 5 / Integrante 5](5.5.md)

# 5.5. M√≥dulo 5 / Integrante 5

## M√≥dulo: Comunidad y Rese√±as

### Escenario 1: Inyecci√≥n de Contenido Malicioso (Dificultad: F√°cil/Moderada)

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **ESC-CR-01** | **Seguridad** | Un bot intenta publicar 500 rese√±as con spam y scripts maliciosos (XSS) en 10 minutos. | Ataque automatizado (bot). | Endpoint `POST /reviews` y la base de datos de rese√±as. | Producci√≥n | El sistema bloquea al atacante por exceso de peticiones y limpia cualquier script malicioso de las pocas entradas que logren pasar. | Tasa de √©xito del bot menor al 1%. 0 reportes de XSS desde la implementaci√≥n. La IP es bloqueada en menos de 1 minuto. |

- Aplica t√©cnica de **Resistir Ataques** con alternativas:
    1.  Limitaci√≥n de tasa simple + escape de caracteres manual.
    2.  Limitaci√≥n de tasa adaptativa + sanitizaci√≥n automatizada en pipeline.

### T√°ctica Elegida
Limitaci√≥n de Tasa Adaptativa (Rate Limiting) con Redis + Sanitizaci√≥n Automatizada con DOMPurify.

**Contexto:**
El m√≥dulo de rese√±as, al ser un punto de entrada de contenido generado por el usuario (UGC), es un objetivo principal para ataques de spam y Cross-Site Scripting (XSS). Se necesita una defensa robusta que no degrade la experiencia del usuario leg√≠timo. üõ°Ô∏è

**Alternativas:**
1.  **Limitaci√≥n Simple + Escape Manual (F√°cil pero Incompleta):**
    - L√≥gica de `Rate Limiting` en el c√≥digo del servicio (ej. 5 peticiones/minuto por IP).
    - Reemplazo manual de caracteres como `<` y `>` en el backend.
    - Alto riesgo de pasar por alto vectores de ataque (ej. atributos `onload`).
    - Bloqueos r√≠gidos que pueden afectar a usuarios en redes compartidas (NAT).

2.  **Sistema Adaptativo y Automatizado (Moderada y Elegida):**
    - `Rate Limiting` gestionado en el API Gateway o con un middleware centralizado usando **Redis** para un seguimiento preciso y distribuido.
    - La sanitizaci√≥n se realiza con una librer√≠a especializada como **DOMPurify** que elimina todo el HTML/JS no seguro, bas√°ndose en una lista blanca de etiquetas permitidas.
    - Protecci√≥n contra OWASP Top 10 A03:2021 (Inyecci√≥n).

**Criterios de elecci√≥n:**
- **Efectividad de Seguridad:** Cobertura completa contra vectores de spam y XSS conocidos.
- **Experiencia de Usuario:** M√≠nimo impacto en usuarios leg√≠timos.
- **Mantenibilidad:** Soluci√≥n centralizada y automatizada.
- **Rendimiento:** Overhead de la sanitizaci√≥n y el chequeo de l√≠mite debe ser m√≠nimo (< 20ms).

**Decisi√≥n:**
Sistema Adaptativo y Automatizado.

**Sustento:**
Esta t√°ctica proporciona una defensa en profundidad. El **Rate Limiting con Redis (moderado)** detiene el spam masivo, mientras que **DOMPurify (f√°cil)** asegura que cualquier contenido que pase sea inofensivo. Esta soluci√≥n elimina el 99.9% de los ataques de spam y el 100% de los vectores XSS conocidos.

---
### Escenario 2: Falla del Servicio de Rese√±as (Dificultad: Moderada)

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **ESC-CR-03** | **Disponibilidad / Resiliencia** | El servicio de rese√±as deja de responder debido a una sobrecarga en su base de datos. | Falla interna del componente. | Microservicio de Cat√°logo de Juegos (consumidor). | Producci√≥n | La p√°gina de detalle de los juegos carga normalmente, mostrando un mensaje controlado en la secci√≥n de rese√±as en lugar de fallar por completo. | El tiempo de carga de la p√°gina del juego no aumenta m√°s de un 5%. La tasa de error del servicio de Cat√°logo no se ve afectada. |

- Aplica t√©cnica de **Resistir Fallos** con alternativas:
    1.  Llamadas s√≠ncronas sin protecci√≥n.
    2.  Implementaci√≥n del patr√≥n Circuit Breaker.

### T√°ctica Elegida
Patr√≥n de Interruptor de Circuito (Circuit Breaker).

**Contexto:**
El servicio de rese√±as es importante, pero no es cr√≠tico para la funci√≥n principal de vender juegos. Una falla en este servicio secundario no debe impedir que un usuario compre un juego. Se debe evitar una falla en cascada. ‚õìÔ∏è

**Alternativas:**
1.  **Llamadas S√≠ncronas sin Protecci√≥n (F√°cil pero Peligroso):**
    - El servicio de Cat√°logo llama al servicio de Rese√±as y espera una respuesta.
    - Si el servicio de Rese√±as no responde (timeout), el hilo de ejecuci√≥n en el servicio de Cat√°logo se queda bloqueado.
    - **Vulnerabilidad:** M√∫ltiples peticiones concurrentes a p√°ginas de juegos agotar√≠an todos los hilos del servicio de Cat√°logo, provocando su ca√≠da total.

2.  **Implementaci√≥n del Circuit Breaker (Moderada y Elegida):**
    - Se utiliza una librer√≠a como `resilience4j` (Java) o `opossum` (Node.js) para envolver las llamadas al servicio de Rese√±as.
    - Despu√©s de un n√∫mero configurable de fallos, el "circuito se abre" y las llamadas posteriores fallan inmediatamente sin intentar contactar al servicio ca√≠do.
    - Pasado un tiempo, el circuito entra en estado "semi-abierto", permitiendo una llamada de prueba para verificar si el servicio se ha recuperado.

**Criterios de elecci√≥n:**
- **Aislamiento de Fallos:** Prevenir que el fallo de un servicio se propague a otros.
- **Recuperaci√≥n R√°pida:** Permitir que el sistema se recupere una vez que el servicio dependiente vuelve a estar en l√≠nea.
- **Experiencia de Usuario:** Ofrecer una experiencia degradada pero funcional en lugar de un error completo.

**Decisi√≥n:**
Implementaci√≥n del patr√≥n Circuit Breaker.

**Sustento:**
El Circuit Breaker es una t√°ctica fundamental para construir sistemas de microservicios resilientes. Protege a los servicios consumidores de fallos en sus dependencias, asegurando que el sistema en su conjunto permanezca disponible y funcional.

---
### Escenario 3: Carga Lenta de P√°gina con Muchas Rese√±as (Dificultad: F√°cil/Moderada)

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **ESC-CR-04** | **Rendimiento** | Un usuario carga la p√°gina de un juego popular con m√°s de 10,000 rese√±as. | Usuario leg√≠timo. | API de Rese√±as y Frontend. | Operaci√≥n Normal | La p√°gina carga r√°pidamente, mostrando la informaci√≥n principal del juego y el primer "lote" de rese√±as. El resto se carga bajo demanda. | El tiempo de carga inicial de la p√°gina (LCP) es < 2.5 segundos. La consulta a la base de datos para obtener las rese√±as tarda < 100ms. |

- Aplica t√©cnica de **Gestionar Recursos** con alternativas:
    1.  Cargar todas las rese√±as en una sola petici√≥n.
    2.  Paginaci√≥n de datos en la API y almacenamiento en cach√© de datos agregados.

### T√°ctica Elegida
Paginaci√≥n de Datos en la API + Caching de Datos Agregados con Redis.

**Contexto:**
Cargar miles de registros de una base de datos en una sola consulta es ineficiente, lento y puede sobrecargar tanto el servidor como el navegador del cliente. La experiencia del usuario se ve directamente afectada por tiempos de carga prolongados. üê¢

**Alternativas:**
1.  **Cargar Todo de una Vez (F√°cil pero Ineficiente):**
    - El endpoint `GET /reviews` devuelve un JSON con las 10,000 rese√±as.
    - **Vulnerabilidad:** La consulta a la base de datos es extremadamente lenta. La transferencia de datos consume mucho ancho de banda. El navegador puede congelarse al intentar renderizar tantos elementos.

2.  **Paginaci√≥n y Cach√© (Moderada y Elegida):**
    - La API implementa **paginaci√≥n (f√°cil)**, devolviendo las rese√±as en lotes (ej. `GET /reviews?page=1&limit=20`). Los frameworks y ORMs modernos facilitan enormemente esta tarea.
    - Se implementa una **cach√© con Redis (moderado)** para almacenar datos agregados que se calculan con frecuencia, como la calificaci√≥n promedio y el n√∫mero total de rese√±as, evitando consultas costosas en cada carga de p√°gina.

**Criterios de elecci√≥n:**
- **Latencia:** Minimizar el tiempo de carga inicial para el usuario.
- **Eficiencia de Recursos:** Reducir la carga en la base de datos y el consumo de ancho de banda.
- **Experiencia de Usuario:** Proporcionar una interfaz fluida que cargue contenido a medida que el usuario lo necesita (ej. scroll infinito).

**Decisi√≥n:**
Paginaci√≥n de Datos en la API + Caching de Datos Agregados.

**Sustento:**
Esta combinaci√≥n ofrece una mejora dr√°stica del rendimiento con un esfuerzo razonable. La **paginaci√≥n** es una pr√°ctica est√°ndar y f√°cil de implementar que resuelve el problema de la carga masiva de datos. A√±adir una **cach√©** para los datos agregados reduce a√∫n m√°s la carga en la base de datos, garantizando que incluso las p√°ginas m√°s populares se mantengan r√°pidas y responsivas.

[‚¨ÖÔ∏è Anterior](../5.4/5.4.md) | [üè† Home](../../README.md) | [Siguiente ‚û°Ô∏è](../5.6/5.6.md)
