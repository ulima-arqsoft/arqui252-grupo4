> [5. T√°cticas](../../5.md) ‚Ä∫ [5.7. Listado Consolidado](../5.7.md) ‚Ä∫ [5.7.3. T√°cticas de Interoperabilidad](5.7.3.md)

# 5.7.3. T√°cticas de Interoperabilidad

## M√≥dulo 03: Cat√°logo de Productos

## Escenario 1: Orquestaci√≥n de Servicios

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|---|---|---|---|---|---|---|---|
| ESC-CP-05 | Interoperabilidad / Performance | Solicitud del cliente para ver el detalle completo de un producto (info + stock + precio) | Frontend Web / App M√≥vil | API Gateway | Producci√≥n | El sistema orquesta m√∫ltiples llamadas internas y devuelve una respuesta unificada al cliente | Reducci√≥n de RTT (Round Trip Time) / 1 Petici√≥n externa |

- Aplica t√©cnica de **Orquestar servicios (ESB o API Gateway) ‚Äì S04-2** con las siguientes alternativas:
  1. Realizar una **Conexi√≥n directa a cada servicio externo** (El frontend llama a cat√°logo, luego a inventario, luego a precios).
  2. Implementar **Intermediaci√≥n con API Gateway**.

### **T√°ctica Elegida**
**API Gateway REST (Orquestaci√≥n)**

**Contexto:**
La informaci√≥n de un producto "Retro" es compleja: requiere datos descriptivos (Cat√°logo), disponibilidad f√≠sica (Inventario) y valoraciones de mercado actuales (Precios Retro). Hacer que el cliente consuma estos tres servicios por separado genera latencia y acopla el frontend a la l√≥gica interna.

**Alternativas:**
1. **Conexi√≥n directa:**
   - El cliente conoce la ubicaci√≥n de todos los microservicios.
   - "Chatty network": M√∫ltiples llamadas de red para una sola vista.
   - Dificultad para manejar cambios en la ubicaci√≥n de los servicios.

2. **Intermediaci√≥n con API Gateway:**
   - Punto de entrada √∫nico.
   - Patr√≥n *Gateway Aggregation*: Recibe una petici√≥n y despacha varias internas, retornando un JSON consolidado.
   - Seguridad y control de tr√°fico centralizado.

**Criterios de elecci√≥n:**
- **Simplicidad del Cliente:** El frontend solo hace una llamada.
- **Desacoplamiento:** Los servicios internos pueden cambiar sin romper el cliente.
- **Eficiencia:** Menor consumo de ancho de banda en la red p√∫blica.

**Decisi√≥n:**
Se utiliza un API Gateway REST.

**Sustento:**
El Gateway act√∫a como orquestador, combinando la informaci√≥n est√°tica del **cat√°logo** con los datos din√°micos de **inventario** y las fluctuaciones de **precios retro**. Esto simplifica dr√°sticamente la interoperabilidad entre el frontend y el ecosistema de microservicios.


## Escenario 2: Adaptabilidad de la Interfaz

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|---|---|---|---|---|---|---|---|
| ESC-CP-06 | Interoperabilidad / Usabilidad | Visualizaci√≥n de productos con formatos f√≠sicos dispares (Cartucho vs Digital) | Usuario Final | Capa de Presentaci√≥n / API Response | Tiempo de Ejecuci√≥n | El sistema adapta la estructura de datos mostrada ocultando atributos irrelevantes | Tasa de error de interpretaci√≥n de datos ‚Üì |

- Aplica t√©cnica de **Personalizar interfaz (Decorator) ‚Äì T04-2** con las siguientes alternativas:
  1. Usar una **Interfaz fija para todos los productos** (Campos nulos o vac√≠os).
  2. Implementar una **Interfaz adaptable seg√∫n tipo de juego** (Decorator).

### **T√°ctica Elegida**
**Patr√≥n Decorator (Vistas Personalizadas)**

**Contexto:**
En una tienda de juegos retro y actuales, los productos tienen atributos muy distintos. Un "Cartucho de SNES" tiene estado de la etiqueta y caja, un "CD de PS2" tiene estado de rayaduras, y un "C√≥digo Digital" no tiene desgaste f√≠sico. Una interfaz √∫nica mostrar√≠a campos irrelevantes (ej. "Estado de la caja" en un juego digital).

**Alternativas:**
1. **Interfaz fija:**
   - Estructura de datos r√≠gida (tabla √∫nica con muchas columnas NULL).
   - Confusi√≥n para el usuario y mayor peso en la transferencia de datos.

2. **Interfaz adaptable (Decorator):**
   - El objeto base "Producto" se envuelve din√°micamente con decoradores seg√∫n su tipo (Cartucho, CD, Digital).
   - Solo se exponen y renderizan los campos pertinentes al contexto.

**Criterios de elecci√≥n:**
- **Claridad Sem√°ntica:** Los datos entregados deben tener sentido para el tipo de producto.
- **Flexibilidad:** Facilidad para agregar nuevos formatos (ej. "Edici√≥n Coleccionista") sin romper el esquema base.

**Decisi√≥n:**
Se personalizan las vistas usando Decoradores.

**Sustento:**
El uso de **decoradores** permite que el sistema sea interoperable con diferentes formatos de venta (f√≠sico vs digital) de manera limpia. Al ocultar campos innecesarios, se mejora la experiencia del usuario y se optimiza la estructura del JSON entregado por la API.

---

## M√≥dulo 02: Gesti√≥n de Usuarios

## Escenario 1: Estandarizaci√≥n de Autenticaci√≥n

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|---|---|---|---|---|---|---|---|
| ESC-GU-05 | Interoperabilidad / Seguridad | Solicitud de acceso a datos del usuario desde una aplicaci√≥n externa o frontend m√≥vil | Aplicaci√≥n Cliente / Pasarela de Pago | Servicio de Identidad | Tiempo de Ejecuci√≥n | El sistema valida la identidad y permisos mediante tokens est√°ndar sin compartir credenciales | Tasa de rechazo de tokens inv√°lidos 100%, Tiempo de integraci√≥n < 4 horas |

- Aplica t√©cnica de **Est√°ndar OAuth 2.0 / OpenID Connect** con las siguientes alternativas:
  1. Desarrollar una **API personalizada** de autenticaci√≥n (Tokens propietarios).
  2. Implementar **Est√°ndares de autenticaci√≥n (OAuth 2.0 / OIDC)**.

### **T√°ctica Elegida**
**Uso de Est√°ndares (OAuth 2.0 / OIDC)**

**Contexto:**
Para que el m√≥dulo de usuarios pueda interactuar de forma segura con proveedores externos (como Auth0, Google Login) y con los otros m√≥dulos internos, se necesita un lenguaje com√∫n de autorizaci√≥n. Los esquemas de seguridad "inventados en casa" suelen ser dif√≠ciles de integrar y propensos a vulnerabilidades.

**Alternativas:**
1. **API personalizada:**
   - Mecanismos de sesi√≥n propietarios.
   - Dificulta la integraci√≥n con librer√≠as est√°ndar de terceros.
   - Requiere documentaci√≥n extensa y mantenimiento manual.

2. **Est√°ndares (OAuth 2.0 / OIDC):**
   - Protocolo universal para autorizaci√≥n y autenticaci√≥n.
   - Soporte nativo en casi todos los lenguajes y frameworks modernos.
   - Uso de tokens JWT (JSON Web Tokens) autolineales.

**Criterios de elecci√≥n:**
- **Compatibilidad:** Capacidad de conectarse con Auth0 y pasarelas de pago sin adaptadores complejos.
- **Seguridad:** Adopci√≥n de flujos probados por la industria (ej. Authorization Code Flow).

**Decisi√≥n:**
Se utiliza OAuth 2.0 / OIDC.

**Sustento:**
Al adherirse a **OAuth 2.0 y OpenID Connect**, garantizamos una interoperabilidad total con el proveedor de identidad (Auth0) y facilitamos que futuras aplicaciones (como una App M√≥vil nativa) consuman el servicio de usuarios de manera segura y estandarizada.


## Escenario 2: Exposici√≥n de Servicios

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|---|---|---|---|---|---|---|---|
| ESC-GU-06 | Interoperabilidad / Integrabilidad | El M√≥dulo de Carrito (CCP) necesita validar la direcci√≥n de env√≠o del usuario actual | M√≥dulos Internos (CCP, CP) | API del Servicio de Usuarios | Desarrollo / Producci√≥n | El m√≥dulo expone un contrato de interfaz claro y predecible que permite el consumo de datos sin errores de formato | Tiempo de desarrollo de integraci√≥n reducido en 50% |

- Aplica t√©cnica de **Exposici√≥n de endpoints REST normalizados** con las siguientes alternativas:
  1. Usar **Puntos finales no tipificados** (Respuestas ad-hoc, sin estructura fija).
  2. Aplicar **Est√°ndar REST con especificaci√≥n OpenAPI**.

### **T√°ctica Elegida**
**API RESTful con Contrato OpenAPI (Swagger)**

**Contexto:**
En una arquitectura distribuida, los m√≥dulos de Carrito de Compras (CCP) y Cat√°logo (CP) necesitan consumir datos del usuario. Si la API de usuarios cambia sus respuestas sin aviso o usa estructuras inconsistentes, romper√° la funcionalidad de los otros m√≥dulos ("Spaghetti integration").

**Alternativas:**
1. **Puntos finales no tipificados:**
   - R√°pido de escribir, pesadilla de mantener.
   - Falta de verbos HTTP adecuados (ej. usar GET para borrar).
   - Alta probabilidad de errores en tiempo de ejecuci√≥n por tipos de datos incorrectos.

2. **Est√°ndar REST (OpenAPI):**
   - Recursos definidos por URLs claras (ej. `/users/{id}/address`).
   - Contrato de interfaz documentado autom√°ticamente (Swagger).
   - Uso correcto de c√≥digos de estado HTTP (200, 404, 500).

**Criterios de elecci√≥n:**
- **Estandarizaci√≥n:** Comunicaci√≥n fluida entre equipos de desarrollo distintos.
- **Documentaci√≥n:** Generaci√≥n autom√°tica de clientes para los otros m√≥dulos.

**Decisi√≥n:**
Se aplican endpoints REST con especificaci√≥n OpenAPI.

**Sustento:**
Esta t√°ctica asegura una **integraci√≥n fluida** entre el m√≥dulo de Usuarios y los m√≥dulos de Carrito (CCP) y Cat√°logo (CP). Al definir un contrato estricto mediante **OpenAPI**, cualquier cambio en la API de usuarios es detectado antes de afectar a los consumidores, garantizando la estabilidad del ecosistema completo.

---

##  M√≥dulo 03: Carrito de Compras y Pedidos

## Escenario 1

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|--------------------|--------------------------|---------------|--------------------------|----------------|---------------|--------------------------|---------------------------|
| ESC-ESC-05 | Interoperabilidad | Integrar m√≥dulo de pedidos con sistema externo de log√≠stica | API de terceros | M√≥dulo de Pedidos | Entorno Cloud | Comunicaci√≥n exitosa entre GameVault y sistema log√≠stico externo | Integraci√≥n < 6 h sin errores |

- Aplica t√©cnica de **Uso de Gateways y API Normalizadas** con las siguientes alternativas:  
  1. Implementar **API Gateway con traducci√≥n de protocolos (REST ‚Üî SOAP)**.  
  2. Usar **middleware de mensajer√≠a asincr√≥nica (RabbitMQ)**.

### **T√°ctica Elegida**
**Gateway API Normalizado**

**Contexto:**  
El sistema debe enviar datos de pedidos y seguimiento a servicios log√≠sticos externos (p.e. Env√≠aYa, DHL).

**Alternativas:**  
1. **API Gateway:**  
   - Estandariza los mensajes JSON/XML.  
   - Simplifica la integraci√≥n multi-proveedor.  

2. **Middleware Asincr√≥nico:**  
   - Env√≠a y recibe mensajes sincr√≥nicos con resiliencia.  
   - Aumenta complejidad inicial.  

**Criterios de elecci√≥n:**  
- **Compatibilidad:** M√∫ltiples servicios soportados.  
- **Simplicidad:** Baja curva de implementaci√≥n.  
- **Seguridad:** Control de acceso unificado.  

**Decisi√≥n:**  
API Gateway.  

**Sustento:**  
Permite interoperabilidad fluida entre GameVault y proveedores log√≠sticos sin necesidad de cambios en el c√≥digo del backend.  
Reduce errores de integraci√≥n y acelera la conexi√≥n con nuevos socios comerciales.  

### Escenario 2

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|--------------------|--------------------------|---------------|--------------------------|----------------|--------------|----------------|----------------|
| ESC-ESC-06 | Interoperabilidad | Conexi√≥n con sistema ERP para stock | Sistema ERP | Servicio de carrito | Producci√≥n | Sincronizaci√≥n autom√°tica | Actualizaci√≥n en < 1 min |

**Aplica t√©cnica de Integraci√≥n por Colas de Mensajes con alternativas:**  
1. Webhooks directos.  
2. Mensajer√≠a asincr√≥nica (RabbitMQ).

### **T√°ctica Elegida**
**Mensajer√≠a Asincr√≥nica**

**Contexto:**  
El carrito necesita conocer el stock actualizado en tiempo real sin sobrecargar el ERP con solicitudes directas.

**Alternativas:**

**1. Webhooks:**  
- Comunicaci√≥n inmediata pero poco escalable.  

**2. Mensajer√≠a Asincr√≥nica:**  
- Desacopla los sistemas y permite procesamiento en segundo plano.  

**Criterios:**  
- Escalabilidad  
- Robustez  
- Tolerancia a fallos  

**Decisi√≥n:**  
Mensajer√≠a Asincr√≥nica.

**Sustento:**  
Optimiza el intercambio de informaci√≥n entre el ERP y el carrito, evitando saturaci√≥n del sistema principal y garantizando consistencia de stock sin bloqueo del flujo de compra.

---

##  M√≥dulo 04: Sistema de Pagos

## Escenario 1

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|--------------------|--------------------------|---------------|--------------------------|----------------|---------------|--------------------------|---------------------------|
| ESC-SP-05 | Interoperabilidad | Integrar un nuevo servicio de pago internacional | API Externa | Sistema de Pagos | Entorno Cloud | El sistema se comunica correctamente con la nueva API | Integraci√≥n exitosa < 6 h |

- Aplica t√©cnica de **Uso de Adaptadores** con las siguientes alternativas:  
  1. Implementar **Gateway API con normalizaci√≥n de datos**.  
  2. Usar **middleware de traducci√≥n JSON/XML**.

### **T√°ctica Elegida**
**Uso de Adaptadores**

**Contexto:**  
GameVault requiere integrar servicios de pago internacionales con diferentes formatos y protocolos (REST, SOAP).

**Alternativas:**  
1. **Gateway API:**  
   - Centraliza la comunicaci√≥n y transforma formatos autom√°ticamente.  
   - Reduce errores de incompatibilidad.  

2. **Middleware Traductor:**  
   - Traduce mensajes en tiempo real (JSON ‚Üî XML).  
   - Aumenta latencia m√≠nima.  

**Criterios de elecci√≥n:**  
- **Compatibilidad:** M√∫ltiples protocolos soportados.  
- **Eficiencia:** Baja latencia.  
- **Mantenibilidad:** Configuraci√≥n modular.  

**Decisi√≥n:**  
Gateway API.

**Sustento:**  
Esta t√©cnica asegura interoperabilidad entre servicios heterog√©neos con m√≠nima fricci√≥n, permitiendo expansi√≥n internacional sin redise√±ar la arquitectura base.

### Escenario 2

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|------------------|------------------------|--------------|------------------------|---------------|-------------|----------------|----------------|
| ESC-SP-06 | Interoperabilidad | Comunicaci√≥n con sistema bancario externo | Banco | Servicio de Validaci√≥n de Pagos | Producci√≥n | Transacciones validadas correctamente | Integraci√≥n 100% exitosa |

**Aplica t√©cnica de Normalizaci√≥n de Datos con alternativas:**  
1. Adaptadores individuales por banco  
2. Gateway √∫nico con reglas de transformaci√≥n

### **T√°ctica Elegida**
**Gateway √∫nico con normalizaci√≥n**

**Contexto:**  
Se requiere validar pagos a trav√©s de distintos bancos sin modificar c√≥digo central por cada entidad.

**Alternativas:**

**1. Adaptadores individuales:**  
- Cada banco necesita integraci√≥n espec√≠fica  
- Alto mantenimiento  

**2. Gateway √∫nico:**  
- Normaliza transacciones y formatos  
- Reduce complejidad y errores  

**Criterios:**  
- Compatibilidad con m√∫ltiples bancos  
- Facilidad de mantenimiento  
- Tiempo de integraci√≥n  

**Decisi√≥n:**  
Gateway √∫nico.

**Sustento:**  
Optimiza tiempo de integraci√≥n y garantiza interoperabilidad con m√∫ltiples bancos sin afectar continuidad de operaciones.

---

## M√≥dulo 06: An√°lisis de Datos y Reportes

## Escenario 1: Consumo de M√©tricas Anal√≠ticas por Microservicios

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|---|---|---|---|---|---|---|---|
| ESC-ADR-05 | Interoperabilidad | El microservicio de Cat√°logo necesita el precio promedio de un juego retro para una alerta de stock. | Microservicios Transaccionales (Cat√°logo, Comunidad) | Data Marts / API Gateway | Producci√≥n | El sistema expone las m√©tricas pre-calculadas como un servicio, sin dar acceso directo a la base de datos anal√≠tica. | Latencia de consulta de m√©tricas < 100 ms. |

- Aplica t√©cnica de **Protocolo Est√°ndar (REST)** con las siguientes alternativas:
  1. Forzar la **Conexi√≥n nativa a DB** anal√≠tica (SQL).
  2. Exponer los resultados a trav√©s de **API REST para Data Marts**.

### **T√°ctica Elegida**
**API REST para Data Marts**

**Contexto:**
El Cat√°logo de Productos y el m√≥dulo de Comunidad necesitan consumir m√©tricas complejas (ej. tendencias de b√∫squeda, precios promedio hist√≥ricos) generadas por los *scripts* de **Python**. Darles acceso directo a la base de datos anal√≠tica generar√≠a un fuerte **acoplamiento** y un riesgo de rendimiento.

**Alternativas:**
1. **Conexi√≥n nativa a DB:**
   - La l√≥gica de negocio debe saber c√≥mo y d√≥nde est√°n almacenados los datos anal√≠ticos.
   - Alto riesgo de saturaci√≥n del Data Warehouse por consultas transaccionales.

2. **API REST para Data Marts:**
   - El resultado del an√°lisis de **Pandas/NumPy** se expone como un **servicio desacoplado**.
   - Los microservicios consumen un endpoint HTTP simple, sin importar la complejidad anal√≠tica subyacente.

**Criterios de elecci√≥n:**
- **Desacoplamiento:** Aislar los sistemas transaccionales del anal√≠tico.
- **Simplicidad de Integraci√≥n:** Uso de un est√°ndar (REST) compatible con todos los microservicios.

**Decisi√≥n:**
Se utiliza **API REST para Data Marts** para exponer resultados de an√°lisis al resto de microservicios.

**Sustento:**
El uso de una **API REST** para exponer las m√©tricas anal√≠ticas garantiza la **Interoperabilidad** al establecer un contrato de datos claro. Esto permite que el Cat√°logo use, por ejemplo, los datos de tendencias retro sin tener que entender la l√≥gica del *pipeline* de **Python** que los gener√≥.


## Escenario 2: Ingesta As√≠ncrona de Datos Transaccionales

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|---|---|---|---|---|---|---|---|
| ESC-ADR-06 | Interoperabilidad | Se realiza una nueva venta de un juego retro en el M√≥dulo de Pagos. | M√≥dulo de Pagos / Base de Datos Transaccional | Bus de Mensajes (Kafka) | Producci√≥n | El cambio en la base de datos es capturado como un evento y enviado al Data Lake sin impactar la transacci√≥n. | Latencia de ingesta de eventos < 1 minuto. |

- Aplica t√©cnica de **Bus de Mensajes (Kafka)** con las siguientes alternativas:
  1. **Integraci√≥n directa de DB** (Consultas de *polling* o r√©plicas s√≠ncronas).
  2. **Cambio de Datos de Captura (CDC) con Kafka**.

### **T√°ctica Elegida**
**Cambio de Datos de Captura (CDC) con Kafka**

**Contexto:**
El Data Lake debe recibir todos los datos transaccionales (ventas, rese√±as, nuevos usuarios) de manera as√≠ncrona para que los *scripts* de **Python** puedan analizarlos. El **acoplamiento directo** a la DB transaccional (ej. consultas SELECT intensivas) degrada el rendimiento del negocio principal.

**Alternativas:**
1. **Integraci√≥n directa de DB:**
   - Requiere que el m√≥dulo de an√°lisis "pregunte" constantemente a la DB principal.
   - Alto consumo de recursos en la base de datos de producci√≥n.

2. **Cambio de Datos de Captura (CDC) con Kafka:**
   - Monitorea el log de transacciones (WAL) de la DB y convierte los cambios en eventos. 
   - **Kafka** act√∫a como el bus, desacoplando los productores (M√≥dulo de Pagos) de los consumidores (M√≥dulo de An√°lisis).

**Criterios de elecci√≥n:**
- **Asincron√≠a:** Evitar el impacto en el rendimiento del sistema transaccional.
- **Fiabilidad:** Asegurar que ning√∫n evento de datos se pierda durante la transferencia.
- **Escalabilidad:** Kafka es escalable para manejar el volumen de eventos de todo GameVault.

**Decisi√≥n:**
Se usa **Cambio de Datos de Captura (CDC) con Kafka** para la ingesta as√≠ncrona.

**Sustento:**
Esta t√°ctica garantiza la **Interoperabilidad** entre los sistemas transaccionales y anal√≠ticos sin sacrificar el rendimiento de las ventas. **Kafka** proporciona el *buffer* necesario para que el **Data Lake** sea alimentado en tiempo casi real, listo para que los modelos de **Python** comiencen su procesamiento.

---

[‚¨ÖÔ∏è Anterior](../5.7.2/5.7.2.md) | [üè† Home](../../../README.md) | [Siguiente ‚û°Ô∏è](../5.7.4/5.7.4.md)