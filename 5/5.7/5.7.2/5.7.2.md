> [5. T√°cticas](../../5.md) ‚Ä∫ [5.7. Listado Consolidado](../5.7.md) ‚Ä∫ [5.7.2. T√°cticas de Mantenibilidad](5.7.2.md)

# 5.7.2. T√°cticas de Mantenibilidad

## M√≥dulo 01: Cat√°logo de Productos

## Escenario 1: Desacoplamiento y Cohesi√≥n

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|---|---|---|---|---|---|---|---|
| ESC-CP-07 | Mantenibilidad | Solicitud de cambios en la estructura del cat√°logo o l√≥gica de visualizaci√≥n | Equipo de Desarrollo / Negocio | Arquitectura del Sistema | Tiempo de Desarrollo / Mantenimiento | Los cambios en el cat√°logo no impactan ni requieren recompilaci√≥n del m√≥dulo de ventas | Independencia de despliegue (Deploy) |

- Aplica t√©cnica de **Reducir acoplamiento y aumentar cohesi√≥n ‚Äì T04-1** con las siguientes alternativas:
  1. Mantener la **L√≥gica del cat√°logo dentro del m√≥dulo de ventas** (Arquitectura monol√≠tica o acoplada).
  2. Implementar el **Cat√°logo como servicio independiente**.

### **T√°ctica Elegida**
**Microservicio Independiente (Alta Cohesi√≥n/Bajo Acoplamiento)**

**Contexto:**
A medida que el sistema crece, mezclar la l√≥gica de visualizaci√≥n de productos (Cat√°logo) con la l√≥gica transaccional (Ventas/Carrito) genera un c√≥digo dif√≠cil de mantener. Un error en el cat√°logo podr√≠a tumbar el proceso de ventas si est√°n fuertemente acoplados.

**Alternativas:**
1. **L√≥gica dentro del m√≥dulo de ventas:**
   - Desarrollo inicial m√°s r√°pido (todo en un lugar).
   - Dificultad para escalar equipos (conflictos de c√≥digo).
   - Alto riesgo de efectos colaterales al modificar funciones.

2. **Cat√°logo como servicio independiente:**
   - Separaci√≥n clara de responsabilidades.
   - Comunicaci√≥n v√≠a API REST/gRPC.
   - Permite desplegar mejoras en el cat√°logo sin detener las ventas.

**Criterios de elecci√≥n:**
- **Mantenibilidad:** Facilidad para localizar y corregir errores.
- **Escalabilidad Organizacional:** Equipos distintos pueden trabajar en Cat√°logo y Ventas en paralelo.

**Decisi√≥n:**
Se crea un microservicio independiente de cat√°logo.

**Sustento:**
Al aislar el cat√°logo con su propia API y base de datos (alta cohesi√≥n), garantizamos que la evoluci√≥n de la presentaci√≥n de productos no afecte la estabilidad del n√∫cleo transaccional, facilitando la mantenibilidad a largo plazo.

---

## Escenario 2: Flexibilidad de Filtros

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|---|---|---|---|---|---|---|---|
| ESC-CP-08 | Mantenibilidad / Modificabilidad | Necesidad de agregar o modificar criterios de b√∫squeda (temporada, nuevos atributos) | Administrador del Sistema / Marketing | M√≥dulo de B√∫squeda y Filtrado | Producci√≥n | El nuevo filtro aparece disponible sin necesidad de tocar c√≥digo fuente ni realizar despliegues | Tiempo de implementaci√≥n < 5 min (Configuraci√≥n) |

- Aplica t√©cnica de **Parametrizaci√≥n ‚Äì S04-1** con las siguientes alternativas:
  1. Definir **Filtros fijos en c√≥digo** (Hardcoded).
  2. Utilizar **Filtros configurables desde BD o archivo**.

### **T√°ctica Elegida**
**Parametrizaci√≥n de Filtros**

**Contexto:**
Las necesidades del negocio cambian r√°pidamente (ej. a√±adir filtro por "Cyber Wow" o una nueva "Consola"). Si cada cambio de filtro requiere intervenci√≥n de un programador, el *Time-to-Market* se vuelve lento y costoso.

**Alternativas:**
1. **Filtros fijos en c√≥digo:**
   - L√≥gica `if/else` r√≠gida en el backend.
   - Requiere ciclo completo de desarrollo (Code -> Test -> Deploy) para un cambio menor.

2. **Filtros configurables (BD/Archivo):**
   - Metadatos definidos externamente.
   - El frontend renderiza los filtros din√°micamente bas√°ndose en la configuraci√≥n recibida.

**Criterios de elecci√≥n:**
- **Modificabilidad:** Capacidad de adaptar el software a cambios de negocio sin programaci√≥n.
- **Eficiencia:** Reducci√≥n de horas-hombre de desarrollo para tareas triviales.

**Decisi√≥n:**
Se implementa la parametrizaci√≥n de filtros.

**Sustento:**
Esta t√°ctica permite que un administrador gestione los filtros (por consola, g√©nero, a√±o, precio) directamente desde una base de datos o panel de administraci√≥n. Esto elimina la necesidad de modificar el c√≥digo fuente para cambios operativos frecuentes, mejorando dr√°sticamente la mantenibilidad.

---

## M√≥dulo 02: Gesti√≥n de Usuarios

## Escenario 1: Desacoplamiento de Responsabilidades

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|---|---|---|---|---|---|---|---|
| ESC-GU-03 | Mantenibilidad / Modificabilidad | Necesidad de actualizar datos del perfil (ej. a√±adir "Avatar" o "Bio") sin tocar la seguridad | Equipo de Producto / Desarrollo | C√≥digo Fuente del Servicio de Usuarios | Tiempo de Desarrollo | Los cambios en la estructura del perfil no afectan ni requieren el redestiegue del m√≥dulo de login/seguridad | Aislamiento de fallos (Side effects) = 0 |

- Aplica t√©cnica de **Separaci√≥n de l√≥gica de autenticaci√≥n y perfiles** con las siguientes alternativas:
  1. Mantener un **C√≥digo unificado** (Monolito donde Login y Perfil son la misma clase/entidad).
  2. Implementar un **Microservicio modular (Auth / Perfil)** separados l√≥gicamente.

### **T√°ctica Elegida**
**Separaci√≥n Modular (Separation of Concerns)**

**Contexto:**
La autenticaci√≥n (Auth) es un proceso cr√≠tico y estable que rara vez cambia, mientras que la gesti√≥n de perfiles (Profile) suele requerir cambios frecuentes por requerimientos de negocio (nuevos campos, preferencias, redes sociales). Mantenerlos juntos aumenta el riesgo de introducir *bugs* de seguridad al modificar campos triviales del perfil.

**Alternativas:**
1. **C√≥digo unificado:**
   - Desarrollo inicial r√°pido.
   - Alto acoplamiento: Un error al guardar el "Nickname" podr√≠a romper el inicio de sesi√≥n.

2. **Microservicio modular:**
   - **Auth:** Se encarga solo de credenciales, tokens y validaci√≥n.
   - **Perfil:** Se encarga de datos demogr√°ficos y preferencias.
   - Comunicaci√≥n v√≠a IDs internos (UUID).

**Criterios de elecci√≥n:**
- **Estabilidad:** Proteger el n√∫cleo de seguridad contra cambios frecuentes en la UI de usuario.
- **Especializaci√≥n:** Facilita que equipos distintos mantengan cada m√≥dulo.

**Decisi√≥n:**
Se implement√≥ separaci√≥n modular entre autenticaci√≥n y gesti√≥n de perfil.

**Sustento:**
Esta arquitectura facilita el mantenimiento al aislar la complejidad. Podemos actualizar, refactorizar o ampliar los datos del usuario (Perfil) tantas veces como sea necesario sin temor a comprometer la l√≥gica de acceso y seguridad (Auth), cumpliendo con el Principio de Responsabilidad √önica (SRP).

---

## Escenario 2: Gesti√≥n de Configuraci√≥n

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|---|---|---|---|---|---|---|---|
| ESC-GU-04 | Mantenibilidad / Seguridad | Necesidad de migrar la aplicaci√≥n de un entorno de Desarrollo a Producci√≥n | DevOps / Administrador de Sistemas | Archivos de Configuraci√≥n | Despliegue (Deployment) | El sistema cambia su comportamiento (URLs, Credenciales) sin modificar una sola l√≠nea de c√≥digo | Tiempo de configuraci√≥n < 2 min |

- Aplica t√©cnica de **Configuraci√≥n mediante variables de entorno seguro** con las siguientes alternativas:
  1. Usar **Configuraci√≥n est√°tica** (Hardcoding en constantes dentro del c√≥digo).
  2. Utilizar **Variables de entorno (.env) y gestores de secretos**.

### **T√°ctica Elegida**
**Externalizaci√≥n de Configuraci√≥n (12-Factor App)**

**Contexto:**
Un sistema moderno debe ejecutarse en m√∫ltiples entornos (Local, QA, Staging, Producci√≥n). Si las credenciales de base de datos o claves de API est√°n escritas dentro del c√≥digo fuente, es imposible promover el c√≥digo entre entornos sin reescribir y recompilar, adem√°s de exponer secretos en el repositorio de versiones (Git).

**Alternativas:**
1. **Configuraci√≥n est√°tica:**
   - Valores fijos en el c√≥digo.
   - Requiere recompilaci√≥n para cambiar una contrase√±a.
   - Alto riesgo de seguridad (Leaks).

2. **Variables de entorno (.env):**
   - Los valores se inyectan al iniciar el contenedor o servidor.
   - El mismo artefacto de c√≥digo funciona en cualquier entorno simplemente cambiando el archivo de variables.

**Criterios de elecci√≥n:**
- **Portabilidad:** El c√≥digo debe ser agn√≥stico al entorno donde corre.
- **Seguridad:** Las credenciales no deben estar versionadas en el control de c√≥digo fuente.

**Decisi√≥n:**
Se usa .env y secretos del entorno.

**Sustento:**
El uso de **variables de entorno y secretos** garantiza una implementaci√≥n limpia y segura. Permite a los administradores rotar claves de API o cambiar endpoints de bases de datos instant√°neamente sin intervenci√≥n de los desarrolladores, facilitando enormemente las tareas de operaciones (DevOps) y mantenimiento.

---

##  M√≥dulo 03: Carrito de Compras y Pedidos

### Escenario 1

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|--------------------|--------------------------|---------------|--------------------------|----------------|--------------|----------------|----------------|
| ESC-CCP-03 | Mantenibilidad | Solicitud de agregar nuevo m√©todo de env√≠o | Equipo de desarrollo | M√≥dulo de Pedidos | Entorno Dev | Integraci√≥n sin afectar pedidos activos | Tiempo de actualizaci√≥n < 3 h |

**Tipo de decisi√≥n:**  
Estrategia de extensibilidad del m√≥dulo de pedidos.

**Aplica t√©cnica de Encapsulamiento de Interfaces con alternativas:**  
1. Aplicar patr√≥n Strategy.  
2. Aplicar patr√≥n Factory.

### **T√°ctica Elegida**
**Patr√≥n Strategy**

**Contexto:**  
Cada proveedor de env√≠o (Olva, Urbano, Shalom) posee APIs distintas. Es necesario mantener independencia entre cada integraci√≥n sin alterar la l√≥gica del m√≥dulo principal.

**Alternativas:**

**1. Patr√≥n Factory:**  
- Permite crear instancias de env√≠o bajo demanda.  
- Centraliza la creaci√≥n, pero puede acoplarse al m√≥dulo principal.  

**2. Patr√≥n Strategy:**  
- Define una interfaz gen√©rica de env√≠o.  
- Permite cambiar proveedores din√°micamente sin modificar la l√≥gica base.  

**Criterios de elecci√≥n:**  
- **Flexibilidad:** Cambio de estrategia sin refactorizar.  
- **Mantenibilidad:** Bajo acoplamiento y alta cohesi√≥n.  
- **Reutilizaci√≥n:** Reuso en futuras integraciones de transporte.  

**Decisi√≥n:**  
Patr√≥n Strategy.

**Sustento:**  
Facilita agregar o cambiar proveedores log√≠sticos con m√≠nimo impacto en el c√≥digo existente. Mejora la mantenibilidad al centralizar la l√≥gica de env√≠o bajo una interfaz abstracta, permitiendo escalar el sistema sin introducir dependencias r√≠gidas.

---

### Escenario 2

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|--------------------|--------------------------|---------------|--------------------------|----------------|--------------|----------------|----------------|
| ESC-CCP-04 | Mantenibilidad | Actualizaci√≥n de reglas de descuentos | Analista funcional | Servicio de carrito | Producci√≥n | Modificaci√≥n sin detener el sistema | Downtime = 0 min |

**Tipo de decisi√≥n:**  
Gesti√≥n de configuraci√≥n din√°mica.

**Aplica t√©cnica de Parametrizaci√≥n de Reglas con alternativas:**  
1. Uso de archivos JSON externos.  
2. Configuraci√≥n centralizada en base de datos.

### **T√°ctica Elegida**
**Configuraci√≥n Centralizada**

**Contexto:**  
El sistema de carrito permite aplicar m√∫ltiples descuentos combinados. Cada cambio en pol√≠ticas promocionales no debe requerir una nueva implementaci√≥n.

**Alternativas:**

**1. Archivos JSON externos:**  
- Sencillos de modificar, pero requieren despliegue manual.  
- Riesgo de desincronizaci√≥n entre entornos.  

**2. Configuraci√≥n centralizada:**  
- Cambios aplicados desde panel administrativo.  
- Propagaci√≥n inmediata en todos los entornos.  

**Criterios:**  
- **Disponibilidad:** Sin interrupci√≥n del servicio.  
- **Mantenibilidad:** Cambios din√°micos en tiempo real.  
- **Seguridad:** Acceso restringido a roles administrativos.  

**Decisi√≥n:**  
Configuraci√≥n centralizada.

**Sustento:**  
Reduce los tiempos de mantenimiento y evita errores de despliegue. La centralizaci√≥n de reglas en base de datos permite actualizaciones inmediatas y controladas sin reiniciar el backend, manteniendo coherencia en las promociones activas.

---

##  M√≥dulo 04: Sistema de Pagos

### Escenario 1

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|--------------------|--------------------------|---------------|--------------------------|----------------|---------------|--------------------------|---------------------------|
| ESC-SP-03 | Mantenibilidad | Solicitud de agregar nuevo m√©todo de pago | Equipo de Desarrollo | M√≥dulo de Pagos | Entorno Dev | Se integra nuevo m√©todo sin afectar servicios existentes | Tiempo de actualizaci√≥n < 4 h |

- Aplica t√©cnica de **Encapsulamiento de Interfaces** con las siguientes alternativas:  
  1. Implementar **adaptadores para APIs externas**.  
  2. Aplicar **patr√≥n Interface Wrapper**.

### **T√°ctica Elegida**
**Encapsulamiento de Interfaces (Interface Wrapping)**

**Contexto:**  
Cada pasarela (PayPal, Yape, Plin) posee diferentes APIs con formatos y endpoints √∫nicos. Mantener el c√≥digo acoplado complicar√≠a futuras integraciones.

**Alternativas:**  
1. **Integraci√≥n Directa:**  
   - Conexi√≥n individual por cada API.  
   - Mantenimiento complejo al actualizar servicios externos.  

2. **Encapsulamiento con Adaptadores:**  
   - Interfaz unificada que abstrae las diferencias de cada proveedor.  
   - Facilita la extensi√≥n con nuevos m√©todos.  

**Criterios de elecci√≥n:**  
- **Flexibilidad:** Permitir nuevos m√©todos sin refactorizar.  
- **Mantenibilidad:** Reducir dependencias directas.  
- **Reutilizaci√≥n:** Adaptadores independientes del n√∫cleo del sistema.  

**Decisi√≥n:**  
Encapsulamiento con Adaptadores.

**Sustento:**  
Esta t√°ctica mejora la mantenibilidad del sistema al desacoplar la l√≥gica central de los servicios externos. Reduce riesgos de errores al actualizar APIs y acelera la integraci√≥n de nuevas pasarelas de pago.

### Escenario 2

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|------------------|------------------------|--------------|------------------------|---------------|-------------|----------------|----------------|
| ESC-SP-04 | Mantenibilidad | Cambios en validaciones de seguridad | Equipo de Desarrollo | Servicio de Autenticaci√≥n | Entorno Dev | Actualizaci√≥n sin afectar flujo de pagos | Tiempo < 3 h |

**Aplica t√©cnica de Modularizaci√≥n con alternativas:**  
1. Monolito  
2. Servicios modulares independientes

### **T√°ctica Elegida**
**Servicios Modulares**

**Contexto:**  
Actualizaciones frecuentes en autenticaci√≥n y validaci√≥n requieren cambios r√°pidos sin afectar otras funciones del m√≥dulo.

**Alternativas:**

**1. Monolito:**  
- Dependencias complejas  
- Riesgo de errores colaterales  

**2. Servicios Modulares:**  
- Componentes independientes  
- Menor impacto en producci√≥n  

**Criterios:**  
- Mantenibilidad  
- Rapidez de despliegue  
- Reducci√≥n de errores  

**Decisi√≥n:**  
Servicios Modulares

**Sustento:**  
Permite aplicar cambios de seguridad y validaci√≥n sin interrumpir operaciones cr√≠ticas, asegurando continuidad y confiabilidad del m√≥dulo.

---

## M√≥dulo 06: An√°lisis de Datos y Reportes

## Escenario 1: Gesti√≥n de Esquemas Versionada

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|---|---|---|---|---|---|---|---|
| ESC-ADR-03 | Mantenibilidad | Un analista de negocio requiere agregar una nueva columna (ej. "nivel de rareza") al Data Mart principal. | Equipo de Desarrollo / Analista de Datos | Esquemas del Data Warehouse | Tiempo de Desarrollo / CI/CD | El sistema aplica el cambio de esquema de forma automatizada y auditable. | Tiempo de despliegue del esquema < 5 minutos. |

- Aplica t√©cnica de **Esquema como C√≥digo (IaC)** con las siguientes alternativas:
  1. Realizar **Gesti√≥n manual de esquemas** (v√≠a consola SQL).
  2. Implementar **Esquema como C√≥digo (DBT/Terraform)**.

### **T√°ctica Elegida**
**Esquema como C√≥digo (DBT/Terraform)**

**Contexto:**
En un entorno de an√°lisis (Data Warehouse), los esquemas de tablas y vistas cambian constantemente. La **gesti√≥n manual** de estos cambios (a√±adir una columna, modificar un tipo de dato) es propensa a errores, inconsistencias y dificulta la reversi√≥n a estados anteriores.

**Alternativas:**
1. **Gesti√≥n manual de esquemas:**
   - R√°pido para cambios puntuales.
   - Carece de historial de versiones y auditabilidad.
   - Alto riesgo de romper los *scripts* de **Python/Pandas** que dependen de la estructura.

2. **Esquema como C√≥digo (DBT/Terraform):**
   - El esquema se define en archivos de configuraci√≥n versionados (Git). 
   - Permite aplicar y revertir cambios de forma **at√≥mica** y controlada, asegurando la consistencia del Data Warehouse.

**Criterios de elecci√≥n:**
- **Auditabilidad:** Saber exactamente qui√©n, cu√°ndo y por qu√© se modific√≥ un esquema.
- **Reproducibilidad:** Capacidad de reconstruir el entorno de datos en desarrollo o QA.
- **Integraci√≥n CI/CD:** Automatizar la aplicaci√≥n de cambios de esquema.

**Decisi√≥n:**
Se utiliza **Esquema como C√≥digo (DBT/Terraform)** para definir, versionar y validar esquemas de datos.

**Sustento:**
El uso de IaC (Infrastructure as Code) aplicado a los esquemas de datos garantiza la **Mantenibilidad** del m√≥dulo de an√°lisis. Al usar herramientas como **DBT**, aseguramos que los *DataFrames* de **Python/Pandas** que consumen estos datos trabajen siempre con la estructura esperada, previniendo fallos en la capa de reportes.


## Escenario 2: Aislamiento de Fallos en ETL

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|---|---|---|---|---|---|---|---|
| ESC-ADR-04 | Mantenibilidad | Un error de conexi√≥n al Data Lake interrumpe la fase de ingesta (E) de datos. | Infraestructura / Conectividad | C√≥digo del Pipeline de Procesamiento | Producci√≥n | El fallo de ingesta no impide que los pasos de procesamiento y reporte puedan ser ejecutados con los datos disponibles. | Tiempo de aislamiento del fallo < 1 minuto. |

- Aplica t√©cnica de **Servicios Modulares (Python)** con las siguientes alternativas:
  1. Un √∫nico **Monolito de ETL** (Un gran script de Python que hace todo).
  2. Implementar **Servicios Modulares** (Ingesta/Procesamiento/Reporte).

### **T√°ctica Elegida**
**Servicios Modulares (Ingesta/Procesamiento/Reporte)**

**Contexto:**
Los *scripts* de **Python** que manejan el flujo de datos (ETL/ELT) son complejos. Si todo el proceso se ejecuta en un √∫nico script (monolito), un fallo en la fase de **Ingesta** detiene el **Procesamiento** y la **Generaci√≥n de Reportes**, complicando la **Mantenibilidad** y el diagn√≥stico.

**Alternativas:**
1. **Monolito de ETL:**
   - Simplicidad de despliegue inicial.
   - **Alto acoplamiento:** Un error en la lectura de un archivo (`E`) bloquea la transformaci√≥n (`T`) de otros datos.

2. **Servicios Modulares:**
   - **Ingesta:** Script Python que solo lee del Data Lake y lo deposita en el Stage.
   - **Procesamiento:** Script Python/PySpark que toma datos del Stage, aplica **Pandas/NumPy** y genera m√©tricas.
   - **Reporte:** Script Python que expone los resultados.

**Criterios de elecci√≥n:**
- **Aislamiento de Fallos:** Si la ingesta falla, se puede re-ejecutar solo esa parte.
- **Claridad de C√≥digo:** Los scripts de Python se enfocan en una sola tarea (Single Responsibility Principle).

**Decisi√≥n:**
Se implementan **Servicios Modulares (Ingesta/Procesamiento/Reporte)** para aislar fallos en los scripts de Python.

**Sustento:**
La modularizaci√≥n del *pipeline* mediante m√∫ltiples *scripts* de **Python** interconectados (posiblemente orquestados por Airflow) mejora dr√°sticamente la **Mantenibilidad**. Esto asegura que, por ejemplo, los modelos de an√°lisis ya entrenados con **Pandas/NumPy** puedan seguir ejecut√°ndose y generando reportes con los datos disponibles, incluso si la ingesta de datos nuevos se detiene temporalmente.

---

[‚¨ÖÔ∏è Anterior](../5.7.1/5.7.1.md) | [üè† Home](../../../README.md) | [Siguiente ‚û°Ô∏è](../5.7.3/5.7.3.md)