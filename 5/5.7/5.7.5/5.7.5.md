> [5. T√°cticas](../../5.md) ‚Ä∫ [5.6. Listado Consolidado](../5.6.md) ‚Ä∫ [5.6.5. T√°cticas de Seguridad](5.6.5.md)

# 5.6.5. T√°cticas de Seguridad

## M√≥dulo 02: Gesti√≥n de Usuarios

## Escenario 1: Gesti√≥n de Sesiones Seguras

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|---|---|---|---|---|---|---|---|
| ESC-GU-09 | Seguridad | Intento de manipulaci√≥n o robo de sesi√≥n (Session Hijacking) | Atacante / Tr√°fico de red | Servicio de Autenticaci√≥n | Producci√≥n | El sistema detecta y rechaza tokens con firmas inv√°lidas o tokens expirados inmediatamente | Tasa de √©xito de ataques de manipulaci√≥n ‚âà 0% |

- Aplica t√©cnica de **Tokenizaci√≥n con JWT firmado** con las siguientes alternativas:
  1. Usar **Cookies de sesi√≥n** (Manejo de estado en el servidor).
  2. Implementar **JWT firmado (HMAC)** con vencimiento temporal.

### **T√°ctica Elegida**
**JSON Web Tokens (JWT) Firmados y Temporales**

**Contexto:**
La gesti√≥n tradicional de sesiones con cookies y almacenamiento en el servidor (server-side state) es compleja de escalar en arquitecturas distribuidas. Se necesita un mecanismo ligero y sin estado (stateless) para verificar la identidad del usuario en cada llamada a la API.

**Alternativas:**
1. **Cookies de sesi√≥n:**
   - Requiere que todas las instancias del servidor compartan el estado o que se usen Sticky Sessions (dificultad de escalado).
   - El *payload* de la sesi√≥n reside en la base de datos o Redis, requiriendo una consulta por petici√≥n.

2. **JWT firmado:**
   - El estado de la sesi√≥n viaja con el cliente (Header, Payload, Firma).
   - El servidor verifica la **firma** (HMAC) con una clave secreta. No requiere consultar la base de datos para la validaci√≥n de identidad.

**Criterios de elecci√≥n:**
- **Escalabilidad:** Compatible con microservicios y *load balancers* (Stateless).
- **Seguridad:** La firma criptogr√°fica (HMAC) garantiza que el token no ha sido manipulado.
- **Portabilidad:** Est√°ndar compatible con OAuth/OIDC.

**Decisi√≥n:**
Se usa **JWT firmado** con vencimiento temporal.

**Sustento:**
El uso de **JWT** permite una verificaci√≥n de identidad r√°pida y descentralizada. Al incluir una **firma criptogr√°fica** (HMAC o RSA) y una **fecha de expiraci√≥n** (`exp`), se garantiza la integridad del token y se mitiga el riesgo de reutilizaci√≥n de sesiones robadas, cumpliendo con un alto est√°ndar de seguridad para API.


## Escenario 2: Protecci√≥n de Credenciales

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|---|---|---|---|---|---|---|---|
| ESC-GU-10 | Seguridad | Acceso no autorizado a la base de datos (DB Breach) | Atacante con acceso a la BD | Base de Datos de Usuarios | Tiempo de Almacenamiento | Las contrase√±as robadas est√°n cifradas irreversiblemente, haciendo imposible su uso o reversi√≥n | Tiempo de crackeo (Offline) > 1 a√±o por atacante |

- Aplica t√©cnica de **Validaci√≥n de contrase√±as con hash bcrypt** con las siguientes alternativas:
  1. Usar algoritmos r√°pidos y obsoletos (**MD5 / SHA1**).
  2. Implementar algoritmos lentos y resistentes (**Bcrypt / Argon2**).

### **T√°ctica Elegida**
**Hashing Adaptativo (Bcrypt)**

**Contexto:**
Incluso con las mejores defensas, una brecha de seguridad en la base de datos es posible. Si las contrase√±as se almacenan en texto plano o cifradas con m√©todos d√©biles/r√°pidos, el atacante puede descifrarlas f√°cilmente y obtener acceso a todas las cuentas.

**Alternativas:**
1. **MD5 / SHA1:**
   - Son muy r√°pidos, lo cual es perjudicial para contrase√±as (permite a los atacantes probar millones por segundo).
   - Vulnerables a ataques de diccionario y *Rainbow Tables*.

2. **Bcrypt / Argon2:**
   - **Argon2:** Es el est√°ndar actual m√°s recomendado.
   - **Bcrypt:** Es muy robusto, ampliamente soportado y resistente a ataques de *hardware* (GPUs).

**Criterios de elecci√≥n:**
- **Lentitud:** El algoritmo debe ser deliberadamente lento para frustrar ataques de fuerza bruta.
- **Resistencia:** Debe ser resistente a hardware especializado (ASICs/GPUs) mediante el uso de salting y funci√≥n de costo ajustable.

**Decisi√≥n:**
Se selecciona **bcrypt** para proteger contrase√±as.

**Sustento:**
**Bcrypt** es un algoritmo de *hashing* adaptativo basado en el algoritmo Blowfish que incorpora *salt* (valor aleatorio) autom√°ticamente y permite ajustar el "factor de costo" (n√∫mero de iteraciones).  Esto significa que, incluso si la base de datos se ve comprometida, descifrar las contrase√±as se vuelve un proceso prohibitivamente lento y costoso para el atacante, protegiendo as√≠ las credenciales de los usuarios.

---

##  M√≥dulo 03: Carrito de Compras y Pedidos

## Escenario 1

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|--------------------|--------------------------|---------------|--------------------------|----------------|---------------|--------------------------|---------------------------|
| ESC-CCP-09 | Seguridad | Intento de manipulaci√≥n del pedido en tr√°nsito | Usuario malintencionado | API de Pedidos | Producci√≥n | Se bloquea la operaci√≥n y se notifica al sistema de seguridad | Evento detectado en < 1 s |

- Aplica t√©cnica de **Validaci√≥n y Firma Digital** con las siguientes alternativas:  
  1. Implementar **tokens JWT con firma HMAC-SHA256**.  
  2. Validar **integridad mediante checksum por pedido**.

### **T√°ctica Elegida**
**Validaci√≥n y Firma Digital**

**Contexto:**  
El flujo de pedidos puede ser vulnerable a intentos de manipulaci√≥n o interceptaci√≥n si no se valida la integridad de los datos.

**Alternativas:**  
1. **JWT Firmado:**  
   - Asocia token √∫nico por sesi√≥n.  
   - Controla caducidad y trazabilidad.  

2. **Checksum:**  
   - Compara hash de datos originales con recibidos.  
   - Detecta alteraciones no autorizadas.  

**Criterios de elecci√≥n:**  
- **Integridad:** Detecci√≥n inmediata de manipulaci√≥n.  
- **Autenticaci√≥n:** Confirmaci√≥n del origen del pedido.  
- **Eficiencia:** Verificaci√≥n en tiempo real.  

**Decisi√≥n:**  
JWT Fimado.  

**Sustento:**  
Esta t√©cnica aplica la Firma Digital para dividir las responsabilidades de validaci√≥n, permitiendo que la API de Pedidos verifique la integridad y la autenticidad del token r√°pidamente sin consultar la DB, asegurando que cualquier intento de alteraci√≥n sea detectado en menos de 1 segundo.

### Escenario 2

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|--------------------|--------------------------|---------------|--------------------------|----------------|--------------|----------------|----------------|
| ESC-CCP-10 | Seguridad | Intento de sesi√≥n maliciosa | Usuario malintencionado | Carrito de compras | Producci√≥n | Bloqueo y registro de intento | Respuesta < 1 s |

**Aplica t√©cnica de Autenticaci√≥n y Prevenci√≥n con alternativas:**  
1. JWT + sesiones temporales.  
2. Detecci√≥n de comportamiento an√≥malo + bloqueo temporal.

### **T√°ctica Elegida**
**JWT + Sesiones Temporales**

**Contexto:**  
El carrito maneja datos de usuario sensibles y pedidos en curso, por lo que la protecci√≥n de sesi√≥n es cr√≠tica.

**Alternativas:**

**1. JWT:**  
- Tokens temporales firmados.  
- Control granular de permisos.  

**2. Detecci√≥n de comportamiento:**  
- Analiza patrones sospechosos.  
- Complementario, pero no sustituye autenticaci√≥n.  

**Criterios:**  
- Confidencialidad de datos.  
- Integridad de la sesi√≥n.  
- Rapidez de detecci√≥n de intentos maliciosos.  

**Decisi√≥n:**  
JWT.

**Sustento:**  
Protege los datos de usuario y mantiene la continuidad del proceso de compra sin interrupciones, reduciendo riesgos de robo de sesi√≥n y cumpliendo normas de seguridad.

---

##  M√≥dulo 04: Sistema de Pagos

## Escenario 1

| Cod Escenario | Atributo de Calidad | Est√≠mulo | Fuente del Est√≠mulo | Artefacto | Entorno | Respuesta | Medida de Respuesta |
|----------------|--------------------|-----------|----------------------|------------|-----------|-------------|---------------------|
| ESC-SP-09 | Seguridad | Intento de acceso no autorizado al m√≥dulo de pagos | Usuario externo | API REST | Producci√≥n | Bloqueo inmediato y registro del intento | Detecci√≥n < 2 s |

- Aplica t√©cnica de **Autenticaci√≥n y Control de Acceso** con las siguientes alternativas:  
  1. Autenticaci√≥n basada en JWT.  
  2. Integraci√≥n con OAuth 2.0 y roles RBAC.

### **T√°ctica Elegida**
**Autenticaci√≥n JWT + RBAC**  

**Contexto:**  
El m√≥dulo maneja informaci√≥n sensible de transacciones, por lo que requiere mecanismos robustos de control de acceso.  

**Alternativas:**  
1. **JWT simple:**
- Tokens firmados localmente.  
2. **OAuth 2.0 + RBAC:** 
- Control de roles y delegaci√≥n de credenciales.  

**Criterios de Elecci√≥n:**  
- **Seguridad ante ataques de sesi√≥n.**  
- **Escalabilidad en microservicios.**  
- **Auditor√≠a completa.**  

**Decisi√≥n:**  
OAuth 2.0 + RBAC. 

**Sustento:**  
Esta combinaci√≥n es la √∫nica que soporta completamente las necesidades de auditor√≠a y el cumplimiento de est√°ndares de la industria como PCI DSS para informaci√≥n sensible, asegurando el bloqueo inmediato con detecci√≥n en <2 s.

### Escenario 2

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|------------------|------------------------|--------------|------------------------|---------------|-------------|----------------|----------------|
| ESC-SP-10 | Seguridad | Intento de fraude o acceso no autorizado | Usuario malintencionado | API de Pagos | Producci√≥n | Bloqueo de la transacci√≥n y alerta | Respuesta < 1 s |

**Aplica t√©cnica de Autenticaci√≥n y Cifrado con alternativas:**  
1. OAuth 2.0 + JWT  
2. Cifrado TLS 1.3 en toda comunicaci√≥n

### **T√°ctica Elegida**
**OAuth 2.0 + TLS 1.3**

**Contexto:**  
El m√≥dulo de pagos maneja datos cr√≠ticos y transacciones financieras, por lo que la protecci√≥n integral es esencial.

**Alternativas:**

**1. OAuth 2.0 + JWT:**  
- Tokens temporales y firmados.  
- Permite control granular de acceso.  

**2. TLS 1.3:**  
- Cifrado extremo a extremo.  
- Prevenci√≥n de ataques MITM.  

**Criterios:**  
- Confidencialidad y autenticidad  
- Integridad de datos  
- Cumplimiento normativo  

**Decisi√≥n:**  
TLS 1.3.

**Sustento:**  
Protege la informaci√≥n de usuarios y transacciones, garantizando seguridad sin afectar rendimiento. Cumple est√°ndares PCI DSS y GDPR.

---

## M√≥dulo 5: Comunidad y Rese√±as

### Escenario 1: Inyecci√≥n de Contenido Malicioso (Dificultad: F√°cil/Moderada)

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **ESC-CR-01** | **Seguridad** | Un bot intenta publicar 500 rese√±as con spam y scripts maliciosos (XSS) en 10 minutos. | Ataque automatizado (bot). | Endpoint `POST /reviews` y la base de datos de rese√±as. | Producci√≥n | El sistema bloquea al atacante por exceso de peticiones y limpia cualquier script malicioso de las pocas entradas que logren pasar. | Tasa de √©xito del bot menor al 1%. 0 reportes de XSS desde la implementaci√≥n. La IP es bloqueada en menos de 1 minuto. |

- Aplica t√©cnica de **Resistir Ataques** con alternativas:
    1.  Limitaci√≥n de tasa simple + escape de caracteres manual.
    2.  Limitaci√≥n de tasa adaptativa + sanitizaci√≥n automatizada en pipeline.

### T√°ctica Elegida
Limitaci√≥n de Tasa Adaptativa (Rate Limiting) con Redis + Sanitizaci√≥n Automatizada con DOMPurify.

**Contexto:**
El m√≥dulo de rese√±as, al ser un punto de entrada de contenido generado por el usuario (UGC), es un objetivo principal para ataques de spam y Cross-Site Scripting (XSS). Se necesita una defensa robusta que no degrade la experiencia del usuario leg√≠timo. üõ°Ô∏è

**Alternativas:**
1.  **Limitaci√≥n Simple + Escape Manual (F√°cil pero Incompleta):**
    - L√≥gica de `Rate Limiting` en el c√≥digo del servicio (ej. 5 peticiones/minuto por IP).
    - Reemplazo manual de caracteres como `<` y `>` en el backend.
    - Alto riesgo de pasar por alto vectores de ataque (ej. atributos `onload`).
    - Bloqueos r√≠gidos que pueden afectar a usuarios en redes compartidas (NAT).

2.  **Sistema Adaptativo y Automatizado (Moderada y Elegida):**
    - `Rate Limiting` gestionado en el API Gateway o con un middleware centralizado usando **Redis** para un seguimiento preciso y distribuido.
    - La sanitizaci√≥n se realiza con una librer√≠a especializada como **DOMPurify** que elimina todo el HTML/JS no seguro, bas√°ndose en una lista blanca de etiquetas permitidas.
    - Protecci√≥n contra OWASP Top 10 A03:2021 (Inyecci√≥n).

**Criterios de elecci√≥n:**
- **Efectividad de Seguridad:** Cobertura completa contra vectores de spam y XSS conocidos.
- **Experiencia de Usuario:** M√≠nimo impacto en usuarios leg√≠timos.
- **Mantenibilidad:** Soluci√≥n centralizada y automatizada.
- **Rendimiento:** Overhead de la sanitizaci√≥n y el chequeo de l√≠mite debe ser m√≠nimo (< 20ms).

**Decisi√≥n:**
Sistema Adaptativo y Automatizado.

**Sustento:**
Esta t√°ctica proporciona una defensa en profundidad. El **Rate Limiting con Redis (moderado)** detiene el spam masivo, mientras que **DOMPurify (f√°cil)** asegura que cualquier contenido que pase sea inofensivo. Esta soluci√≥n elimina el 99.9% de los ataques de spam y el 100% de los vectores XSS conocidos.

---

## M√≥dulo 05: An√°lisis de Datos y Reportes

## Escenario 1: Acceso Controlado a la Informaci√≥n

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|---|---|---|---|---|---|---|---|
| ESC-ADR-09 | Seguridad | Un analista de marketing intenta acceder a un reporte financiero confidencial. | Usuario de la herramienta de BI | Herramienta de Business Intelligence (BI) | Producci√≥n | El sistema deniega el acceso al reporte o filtra los datos sensibles bas√°ndose en el rol predefinido del usuario. | Cumplimiento del principio de m√≠nimo privilegio (Least Privilege). |

- Aplica t√©cnica de **Control de Acceso (RBAC)** con las siguientes alternativas:
  1. Implementar **Seguridad por tabla** (Permisos a nivel de base de datos).
  2. Implementar **RBAC en la herramienta de BI** (Seguridad en la capa de presentaci√≥n).

### **T√°ctica Elegida**
**RBAC en la Herramienta de BI**

**Contexto:**
Los datos anal√≠ticos de **GameVault** contienen informaci√≥n cr√≠tica sobre ventas y rendimiento. Es fundamental que solo el personal autorizado acceda a ciertos reportes (ej., la junta directiva ve ganancias, el equipo de marketing ve tendencias de b√∫squeda). La seguridad debe ser gestionada en la capa final, cerca del usuario.

**Alternativas:**
1. **Seguridad por tabla:**
   - Dif√≠cil de mantener, ya que los permisos deben replicarse en la base de datos subyacente.
   - Es granular, pero poco usable para administradores de negocio.

2. **RBAC en la herramienta de BI:**
   - La herramienta de BI gestiona los permisos bas√°ndose en los roles del usuario. 
   - Es m√°s intuitivo y permite gestionar filas/columnas de datos directamente en el dashboard.

**Criterios de elecci√≥n:**
- **Usabilidad de la Seguridad:** Facilidad para los administradores de negocio de asignar permisos.
- **Granularidad:** Capacidad de restringir el acceso no solo al reporte, sino a las filas de datos dentro del reporte (Row-Level Security).

**Decisi√≥n:**
Se implementa **RBAC en la herramienta de BI** para limitar el acceso a reportes y vistas sensibles.

**Sustento:**
La implementaci√≥n de **RBAC (Control de Acceso Basado en Roles)** en la herramienta de BI es clave para la **Seguridad**. Al integrar los roles de los usuarios (gestionados en el m√≥dulo de Usuarios) con el acceso a los datos, se asegura que el principio de **m√≠nimo privilegio** se cumpla, protegiendo la informaci√≥n confidencial de la empresa.


## Escenario 2: Protecci√≥n de Datos Personales (PII)

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|---|---|---|---|---|---|---|---|
| ESC-ADR-10 | Seguridad | Un atacante accede al Data Lake y obtiene un volcado de los datos brutos. | Atacante externo / DB Compromise | Data Lake / Pipeline de Ingesta | Producci√≥n | Los datos sensibles (emails, IPs) est√°n ofuscados o sustituidos por identificadores no reversibles. | Cumplimiento de normativas de privacidad (GDPR, CCPA). |

- Aplica t√©cnica de **Anonimizaci√≥n/Tokenizaci√≥n** con las siguientes alternativas:
  1. Depender √∫nicamente del **Cifrado en reposo** del almacenamiento (Storage-Level Encryption).
  2. Realizar **Anonimizaci√≥n de datos sensibles** en la capa de ingesta.

### **T√°ctica Elegida**
**Anonimizaci√≥n de Datos Sensibles**

**Contexto:**
Los *scripts* de **Python** y los modelos anal√≠ticos no necesitan la identidad real del usuario (nombre, email) para calcular tendencias. Exponer datos personales (PII) en el Data Lake es un riesgo de cumplimiento y legal. La **Seguridad** debe proteger la identidad del usuario.

**Alternativas:**
1. **Cifrado en reposo:**
   - Protege los datos de intrusiones en la infraestructura, pero una vez que el atacante tiene las claves, el dato es legible.

2. **Anonimizaci√≥n de datos sensibles:**
   - Los datos personales son reemplazados por un *token* (Tokenization) o son irreversiblemente ofuscados (Hashing) en la **capa ETL**, antes de ser almacenados. 

**Criterios de elecci√≥n:**
- **Protecci√≥n Irreversible:** Asegurar que el dato personal no pueda ser recuperado, incluso si el Data Lake es comprometido.
- **Cumplimiento Legal:** Satisfacer los requisitos de privacidad para reportes y an√°lisis.

**Decisi√≥n:**
Se realiza **Anonimizaci√≥n de datos sensibles** en la capa de ingesta antes de que sean accesibles por los scripts de Python.

**Sustento:**
La **Anonimizaci√≥n** protege la privacidad del usuario, lo cual es un pilar de la **Seguridad** del m√≥dulo de reportes. Al procesar los datos con **Python** solo despu√©s de esta ofuscaci√≥n, se limita la exposici√≥n de la informaci√≥n cr√≠tica, haciendo el Data Lake menos atractivo para los atacantes.

---

[‚¨ÖÔ∏è Anterior](../5.6.4/5.6.4.md) | [üè† Home](../../../README.md) | [Siguiente ‚û°Ô∏è](../5.6.6/5.6.6.md)
