> [5. T√°cticas](../../5.md) ‚Ä∫ [5.6. Listado Consolidado](../5.6.md) ‚Ä∫ [5.6.5. T√°cticas de Seguridad](5.6.5.md)

# 5.6.5. T√°cticas de Seguridad

##  M√≥dulo 03: Carrito de Compras y Pedidos

## Escenario 1

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|--------------------|--------------------------|---------------|--------------------------|----------------|---------------|--------------------------|---------------------------|
| ESC-CCP-09 | Seguridad | Intento de manipulaci√≥n del pedido en tr√°nsito | Usuario malintencionado | API de Pedidos | Producci√≥n | Se bloquea la operaci√≥n y se notifica al sistema de seguridad | Evento detectado en < 1 s |

- Aplica t√©cnica de **Validaci√≥n y Firma Digital** con las siguientes alternativas:  
  1. Implementar **tokens JWT con firma HMAC-SHA256**.  
  2. Validar **integridad mediante checksum por pedido**.

### **T√°ctica Elegida**
**Validaci√≥n y Firma Digital**

**Contexto:**  
El flujo de pedidos puede ser vulnerable a intentos de manipulaci√≥n o interceptaci√≥n si no se valida la integridad de los datos.

**Alternativas:**  
1. **JWT Firmado:**  
   - Asocia token √∫nico por sesi√≥n.  
   - Controla caducidad y trazabilidad.  

2. **Checksum:**  
   - Compara hash de datos originales con recibidos.  
   - Detecta alteraciones no autorizadas.  

**Criterios de elecci√≥n:**  
- **Integridad:** Detecci√≥n inmediata de manipulaci√≥n.  
- **Autenticaci√≥n:** Confirmaci√≥n del origen del pedido.  
- **Eficiencia:** Verificaci√≥n en tiempo real.  

**Decisi√≥n:**  
JWT Fimado.  

**Sustento:**  
Esta t√©cnica aplica la Firma Digital para dividir las responsabilidades de validaci√≥n, permitiendo que la API de Pedidos verifique la integridad y la autenticidad del token r√°pidamente sin consultar la DB, asegurando que cualquier intento de alteraci√≥n sea detectado en menos de 1 segundo.

### Escenario 2

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|--------------------|--------------------------|---------------|--------------------------|----------------|--------------|----------------|----------------|
| ESC-CCP-10 | Seguridad | Intento de sesi√≥n maliciosa | Usuario malintencionado | Carrito de compras | Producci√≥n | Bloqueo y registro de intento | Respuesta < 1 s |

**Aplica t√©cnica de Autenticaci√≥n y Prevenci√≥n con alternativas:**  
1. JWT + sesiones temporales.  
2. Detecci√≥n de comportamiento an√≥malo + bloqueo temporal.

### **T√°ctica Elegida**
**JWT + Sesiones Temporales**

**Contexto:**  
El carrito maneja datos de usuario sensibles y pedidos en curso, por lo que la protecci√≥n de sesi√≥n es cr√≠tica.

**Alternativas:**

**1. JWT:**  
- Tokens temporales firmados.  
- Control granular de permisos.  

**2. Detecci√≥n de comportamiento:**  
- Analiza patrones sospechosos.  
- Complementario, pero no sustituye autenticaci√≥n.  

**Criterios:**  
- Confidencialidad de datos.  
- Integridad de la sesi√≥n.  
- Rapidez de detecci√≥n de intentos maliciosos.  

**Decisi√≥n:**  
JWT.

**Sustento:**  
Protege los datos de usuario y mantiene la continuidad del proceso de compra sin interrupciones, reduciendo riesgos de robo de sesi√≥n y cumpliendo normas de seguridad.

---

##  M√≥dulo 04: Sistema de Pagos

## Escenario 1

| Cod Escenario | Atributo de Calidad | Est√≠mulo | Fuente del Est√≠mulo | Artefacto | Entorno | Respuesta | Medida de Respuesta |
|----------------|--------------------|-----------|----------------------|------------|-----------|-------------|---------------------|
| ESC-SP-09 | Seguridad | Intento de acceso no autorizado al m√≥dulo de pagos | Usuario externo | API REST | Producci√≥n | Bloqueo inmediato y registro del intento | Detecci√≥n < 2 s |

- Aplica t√©cnica de **Autenticaci√≥n y Control de Acceso** con las siguientes alternativas:  
  1. Autenticaci√≥n basada en JWT.  
  2. Integraci√≥n con OAuth 2.0 y roles RBAC.

### **T√°ctica Elegida**
**Autenticaci√≥n JWT + RBAC**  

**Contexto:**  
El m√≥dulo maneja informaci√≥n sensible de transacciones, por lo que requiere mecanismos robustos de control de acceso.  

**Alternativas:**  
1. **JWT simple:**
- Tokens firmados localmente.  
2. **OAuth 2.0 + RBAC:** 
- Control de roles y delegaci√≥n de credenciales.  

**Criterios de Elecci√≥n:**  
- **Seguridad ante ataques de sesi√≥n.**  
- **Escalabilidad en microservicios.**  
- **Auditor√≠a completa.**  

**Decisi√≥n:**  
OAuth 2.0 + RBAC. 

**Sustento:**  
Esta combinaci√≥n es la √∫nica que soporta completamente las necesidades de auditor√≠a y el cumplimiento de est√°ndares de la industria como PCI DSS para informaci√≥n sensible, asegurando el bloqueo inmediato con detecci√≥n en <2 s.

### Escenario 2

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|------------------|------------------------|--------------|------------------------|---------------|-------------|----------------|----------------|
| ESC-SP-10 | Seguridad | Intento de fraude o acceso no autorizado | Usuario malintencionado | API de Pagos | Producci√≥n | Bloqueo de la transacci√≥n y alerta | Respuesta < 1 s |

**Aplica t√©cnica de Autenticaci√≥n y Cifrado con alternativas:**  
1. OAuth 2.0 + JWT  
2. Cifrado TLS 1.3 en toda comunicaci√≥n

### **T√°ctica Elegida**
**OAuth 2.0 + TLS 1.3**

**Contexto:**  
El m√≥dulo de pagos maneja datos cr√≠ticos y transacciones financieras, por lo que la protecci√≥n integral es esencial.

**Alternativas:**

**1. OAuth 2.0 + JWT:**  
- Tokens temporales y firmados.  
- Permite control granular de acceso.  

**2. TLS 1.3:**  
- Cifrado extremo a extremo.  
- Prevenci√≥n de ataques MITM.  

**Criterios:**  
- Confidencialidad y autenticidad  
- Integridad de datos  
- Cumplimiento normativo  

**Decisi√≥n:**  
TLS 1.3.

**Sustento:**  
Protege la informaci√≥n de usuarios y transacciones, garantizando seguridad sin afectar rendimiento. Cumple est√°ndares PCI DSS y GDPR.

---

## M√≥dulo 5: Comunidad y Rese√±as

### Escenario 1: Inyecci√≥n de Contenido Malicioso (Dificultad: F√°cil/Moderada)

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo** | **Fuente del Est√≠mulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **ESC-CR-01** | **Seguridad** | Un bot intenta publicar 500 rese√±as con spam y scripts maliciosos (XSS) en 10 minutos. | Ataque automatizado (bot). | Endpoint `POST /reviews` y la base de datos de rese√±as. | Producci√≥n | El sistema bloquea al atacante por exceso de peticiones y limpia cualquier script malicioso de las pocas entradas que logren pasar. | Tasa de √©xito del bot menor al 1%. 0 reportes de XSS desde la implementaci√≥n. La IP es bloqueada en menos de 1 minuto. |

- Aplica t√©cnica de **Resistir Ataques** con alternativas:
    1.  Limitaci√≥n de tasa simple + escape de caracteres manual.
    2.  Limitaci√≥n de tasa adaptativa + sanitizaci√≥n automatizada en pipeline.

### T√°ctica Elegida
Limitaci√≥n de Tasa Adaptativa (Rate Limiting) con Redis + Sanitizaci√≥n Automatizada con DOMPurify.

**Contexto:**
El m√≥dulo de rese√±as, al ser un punto de entrada de contenido generado por el usuario (UGC), es un objetivo principal para ataques de spam y Cross-Site Scripting (XSS). Se necesita una defensa robusta que no degrade la experiencia del usuario leg√≠timo. üõ°Ô∏è

**Alternativas:**
1.  **Limitaci√≥n Simple + Escape Manual (F√°cil pero Incompleta):**
    - L√≥gica de `Rate Limiting` en el c√≥digo del servicio (ej. 5 peticiones/minuto por IP).
    - Reemplazo manual de caracteres como `<` y `>` en el backend.
    - Alto riesgo de pasar por alto vectores de ataque (ej. atributos `onload`).
    - Bloqueos r√≠gidos que pueden afectar a usuarios en redes compartidas (NAT).

2.  **Sistema Adaptativo y Automatizado (Moderada y Elegida):**
    - `Rate Limiting` gestionado en el API Gateway o con un middleware centralizado usando **Redis** para un seguimiento preciso y distribuido.
    - La sanitizaci√≥n se realiza con una librer√≠a especializada como **DOMPurify** que elimina todo el HTML/JS no seguro, bas√°ndose en una lista blanca de etiquetas permitidas.
    - Protecci√≥n contra OWASP Top 10 A03:2021 (Inyecci√≥n).

**Criterios de elecci√≥n:**
- **Efectividad de Seguridad:** Cobertura completa contra vectores de spam y XSS conocidos.
- **Experiencia de Usuario:** M√≠nimo impacto en usuarios leg√≠timos.
- **Mantenibilidad:** Soluci√≥n centralizada y automatizada.
- **Rendimiento:** Overhead de la sanitizaci√≥n y el chequeo de l√≠mite debe ser m√≠nimo (< 20ms).

**Decisi√≥n:**
Sistema Adaptativo y Automatizado.

**Sustento:**
Esta t√°ctica proporciona una defensa en profundidad. El **Rate Limiting con Redis (moderado)** detiene el spam masivo, mientras que **DOMPurify (f√°cil)** asegura que cualquier contenido que pase sea inofensivo. Esta soluci√≥n elimina el 99.9% de los ataques de spam y el 100% de los vectores XSS conocidos.

[‚¨ÖÔ∏è Anterior](../5.6.4/5.6.4.md) | [üè† Home](../../../README.md) | [Siguiente ‚û°Ô∏è](../5.6.6/5.6.6.md)
