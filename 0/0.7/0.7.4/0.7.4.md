> [0. Acerca del Grupo](../../0.md) ‚Ä∫ [0.7. Trabajo Individual (Patrones Cloud)](../0.7.md) ‚Ä∫ [0.7.4. Integrante 4](0.7.4.md)

# 0.7.4. Integrante 4

## An√°lisis del Patr√≥n: Gateway Aggregation



### 1. Problema Abordado ‚ùì



En arquitecturas de microservicios, una interfaz de usuario cliente (frontend web o m√≥vil) frecuentemente requiere datos de m√∫ltiples servicios backend para renderizar una √∫nica vista. Esta necesidad puede llevar a un patr√≥n de comunicaci√≥n **"chatty" (conversacional)**, donde el cliente realiza numerosas llamadas individuales a diferentes microservicios. Este enfoque presenta varias desventajas significativas:



* **Latencia Acumulada:** M√∫ltiples viajes de ida y vuelta a trav√©s de la red incrementan la latencia total percibida por el usuario.

* **Acoplamiento Cliente-Backend:** El cliente se vuelve dependiente de la estructura interna y la ubicaci√≥n de los microservicios, lo que dificulta la refactorizaci√≥n o evoluci√≥n del backend.

* **Complejidad en el Cliente:** La l√≥gica para orquestar las llamadas, manejar errores individuales y agregar los datos reside en el cliente, aumentando su complejidad.

* **Consumo de Recursos:** Particularmente en dispositivos m√≥viles, m√∫ltiples llamadas pueden impactar negativamente el consumo de bater√≠a y datos.



---

### 2. Soluci√≥n Propuesta por el Patr√≥n



El patr√≥n **Gateway Aggregation** introduce una capa de **agregaci√≥n** en el **API Gateway** (o un servicio Backend-for-Frontend - BFF). Este gateway expone un **√∫nico endpoint** al cliente para la operaci√≥n compuesta. Al recibir una solicitud en este endpoint, el gateway:



1. **Identifica** los microservicios internos requeridos para satisfacer la solicitud.

2. **Despacha** las solicitudes necesarias a los microservicios correspondientes, idealmente en paralelo para optimizar el tiempo.

3. **Espera** las respuestas de cada microservicio.

4. **Agrega** (combina y/o transforma) los datos recibidos en una √∫nica estructura de respuesta.

5. **Devuelve** la respuesta agregada al cliente.







Este mecanismo act√∫a como una **fachada** sobre los microservicios subyacentes, simplificando la interacci√≥n desde la perspectiva del cliente.



---

### 3. Escenario de Aplicaci√≥n: Dashboard de Plataforma de Aprendizaje Online üéì



Consid√©rese una plataforma educativa con microservicios dedicados para `PerfilesDeUsuario`, `InscripcionesACursos` y `TareasPendientes`. La vista principal del estudiante (dashboard) debe mostrar informaci√≥n consolidada de estos tres dominios.



* **Sin el patr√≥n:** El frontend realizar√≠a tres llamadas HTTP separadas: una a cada microservicio.

* **Con Gateway Aggregation:** Se define un endpoint `GET /dashboard-data` en el API Gateway. Al ser invocado, el gateway realiza internamente las tres llamadas a los microservicios `PerfilesDeUsuario`, `InscripcionesACursos` y `TareasPendientes`. Una vez recibidas las respuestas, las combina en una estructura JSON unificada que contiene el perfil, la lista de cursos y las tareas pendientes, y la devuelve al frontend en una sola respuesta HTTP.



---

### 4. Beneficios y Consideraciones



**Beneficios:**



* **Reducci√≥n de Latencia:** Disminuye el n√∫mero de viajes de ida y vuelta de red entre cliente y backend.

* **Simplificaci√≥n del Cliente:** Descarga la l√≥gica de orquestaci√≥n y agregaci√≥n del cliente al gateway.

* **Desacoplamiento Backend:** Permite refactorizar la descomposici√≥n de microservicios sin impactar al cliente.

* **Optimizaci√≥n de Carga √ötil:** El gateway puede adaptar la respuesta a las necesidades espec√≠ficas de cada tipo de cliente (ej. m√≥vil vs. web).



**Consideraciones:**



* **Potencial Cuello de Botella:** El gateway se convierte en un componente cr√≠tico; debe ser altamente disponible y escalable.

* **Aumento de Complejidad en el Gateway:** La l√≥gica de agregaci√≥n reside ahora en el gateway, lo que incrementa su complejidad y responsabilidad.

* **Gesti√≥n de Fallos:** El gateway debe implementar estrategias robustas para manejar fallos parciales (cuando uno de los microservicios internos no responde).



---

## Aplicaci√≥n del Patr√≥n Gateway Aggregation en GameVault



En el proyecto **GameVault**, el patr√≥n **Gateway Aggregation** se implementar√° en el **API Gateway** para optimizar la carga de la **p√°gina de detalle del producto**. Actualmente, para mostrar esta p√°gina, el frontend necesita realizar al menos dos llamadas separadas: una al microservicio de **Cat√°logo de Productos (CP)** para obtener los datos principales del juego (descripci√≥n, precio, im√°genes) y otra al microservicio de **Comunidad y Rese√±as (CR)** para obtener las √∫ltimas rese√±as de los usuarios.



### Implementaci√≥n Propuesta:



Se crear√° un nuevo endpoint en el API Gateway: `GET /aggregated-product-details/{productId}`. Al recibir una solicitud en este endpoint, el API Gateway ejecutar√° las siguientes acciones:



1. Realizar√° llamadas **en paralelo** a:

  * El endpoint `GET /products/{productId}` del microservicio **CP**.

  * El endpoint `GET /reviews?productId={productId}&limit=5&sortBy=date` del microservicio **CR**.

2. Esperar√° las respuestas de ambos microservicios.

3. **Agregar√°** los datos en una √∫nica estructura JSON.

4. Devolver√° esta respuesta consolidada al frontend.



### Beneficio Esperado:



Antes, el frontend realizaba 2 llamadas API secuenciales o paralelas. Con este patr√≥n, se **reduce a 1 sola llamada**. Se espera que esto **disminuya la latencia** total percibida por el usuario al cargar la p√°gina de detalle del producto en al menos un **30-40%** y **simplifique significativamente el c√≥digo del frontend**, al eliminar la necesidad de orquestar m√∫ltiples llamadas y combinar sus resultados. La validaci√≥n se realizar√° comparando los tiempos de carga de red (utilizando las herramientas de desarrollador del navegador) antes y despu√©s de implementar el endpoint agregado.

---

[‚¨ÖÔ∏è Anterior](../0.7.3/0.7.3.md) | [üè† Home](../../../README.md) | [Siguiente ‚û°Ô∏è](../0.7.5/0.7.5.md)