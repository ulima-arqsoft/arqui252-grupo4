> [4. Decisiones Iniciales de Arquitectura](../../4.md) ‚Ä∫ [4.7. Listado Consolidado](../4.7.md) ‚Ä∫ [4.7.1. Asignaci√≥n de Responsabilidades](4.7.1.md)

# 4.7.1. Asignaci√≥n de Responsabilidades

Este apartado define las fronteras de cada microservicio (m√≥dulo) y las responsabilidades √∫nicas que asume dentro del sistema.

## 00: Decisiones Generales
---
### Decisi√≥n 1: Elecci√≥n entre arquitectura monol√≠tica y de microservicios

**T√≠tulo:**
Elecci√≥n entre Arquitectura Monol√≠tica y Arquitectura de Microservicios

**Contexto:**
GameVault requiere manejar m√∫ltiples dominios (compra/venta, cat√°logo masivo, log√≠stica) con diferentes ritmos de cambio y demandas de escalabilidad. El Cat√°logo es de solo lectura y el Carrito/Pedidos es transaccional cr√≠tico, exigiendo alta disponibilidad.

**Alternativas:**

* **Arquitectura Monol√≠tica:** Todos los m√≥dulos integrados. Simplifica el desarrollo inicial, pero un fallo en cualquier componente puede afectar toda la plataforma. Dificulta la escalabilidad modular.

* **Arquitectura de Microservicios:** Cada dominio funciona como servicio independiente. Permite escalabilidad granular, aislamiento de fallos y el uso de tecnolog√≠as espec√≠ficas por m√≥dulo.

**Criterios de Elecci√≥n:**

* **Escalabilidad:** Capacidad de escalar m√≥dulos de alta demanda (Cat√°logo) independientemente de los transaccionales (Pedidos).

* **Disponibilidad y Tolerancia a Fallos:** Garantizar que un fallo en un m√≥dulo no detenga las ventas o la b√∫squeda.

* **Flexibilidad Tecnol√≥gica:** Posibilidad de usar diferentes bases de datos o lenguajes seg√∫n la necesidad del m√≥dulo.

**Decisi√≥n:**
  Arquitectura de Microservicios.

**Sustento:**
  La diferencia en los requisitos de datos y la carga de trabajo entre los dominios de GameVault (ej. Cat√°logo masivo vs. Carrito transaccional) justifica la separaci√≥n. Esta arquitectura garantiza el **Desacoplamiento** y permite la **Escalabilidad Horizontal** granular, lo cual es vital para una plataforma de comercio electr√≥nico que prioriza la **Disponibilidad** de las ventas.

### Decisi√≥n 2: Asignaci√≥n de responsabilidades entre m√≥dulos frontend y backend

**T√≠tulo:**
Divisi√≥n de Responsabilidades entre Frontend (UI) y Backend (L√≥gica de Negocio)

**Contexto:**
GameVault requiere alta interactividad (filtrado instant√°neo, experiencia de compra fluida) con m√°xima seguridad y consistencia en las transacciones (precios, impuestos). Es crucial definir d√≥nde reside la l√≥gica de negocio central.

**Alternativas:**

* **Frontend Grueso:** El Frontend maneja la mayor parte de las validaciones y l√≥gica de estado, usando el Backend solo para persistencia b√°sica.

* **Enfoque H√≠brido:** Frontend maneja estado de UI y validaciones de formato. Backend gestiona la l√≥gica de negocio cr√≠tica, la seguridad, y la consistencia de los datos.

**Criterios de Elecci√≥n:**

* **Seguridad:** La l√≥gica de precios y descuentos debe ser inalterable por el usuario.

* **Consistencia:** Asegurar que los datos mostrados reflejen siempre la √∫nica fuente de verdad.

* **Experiencia de Usuario (UX):** Permitir interacciones r√°pidas y fluidas.

**Decisi√≥n:**
  Enfoque H√≠brido: Backend como Fuente √önica de Verdad para el Negocio.

**Sustento:**
  El Backend es el √∫nico responsable de la **Seguridad** y la **Consistencia** (aplicaci√≥n de reglas de precios e impuestos), previniendo fraude. El Frontend (React) optimiza la **UX** gestionando el estado de la UI y las validaciones de formato.

## 01: M√≥dulo: Cat√°logo de Productos
---
### Decisi√≥n 1: Responsabilidad de la Ingesta y Dispersi√≥n de Datos para B√∫squeda y Filtrado.

**T√≠tulo:**
Estrategia de Persistencia para B√∫squeda y Filtrado de Cat√°logo

**Contexto:**
El Cat√°logo (CP) maneja millones de registros y debe permitir b√∫squedas y filtrados por m√∫ltiples criterios (consola, g√©nero, condici√≥n, rareza) con latencia ultrabaja.

**Alternativas:**

* **Base de Datos Relacional Tradicional:** Usar solo PostgreSQL o MySQL. F√°cil de gestionar, pero lento para b√∫squedas de texto completo y filtrados multidimensionales complejos.

* **Motor de B√∫squeda Dedicado:** Utilizar un motor especializado (ej. Elasticsearch, Solr) para indexar los datos relevantes. Ofrece velocidad y funcionalidad avanzada de b√∫squeda.

**Criterios de Elecci√≥n:**

* **Velocidad de Respuesta:** B√∫squedas y filtros casi instant√°neos ($\le 100$ ms).

* **Funcionalidad:** Soporte nativo para *faceted search* y b√∫squeda de texto.

* **Disponibilidad:** Garantizar que el servicio de b√∫squeda no falle.

**Decisi√≥n:**
  Utilizar un motor de b√∫squeda/√≠ndice dedicado (ej. Elasticsearch) para b√∫squedas y filtrado de alto rendimiento.

**Sustento:**
  Un motor de b√∫squeda dedicado garantiza la **Velocidad de Respuesta** y **Disponibilidad** requeridas para el Cat√°logo. El microservicio CP ser√° responsable de mantener la consistencia entre la base de datos maestra (para la verdad de los datos) y el √≠ndice de b√∫squeda (para la velocidad de consulta).

## 02: M√≥dulo: Gesti√≥n de Usuarios
---
### Decisi√≥n 1: Responsabilidad de la gesti√≥n de la identidad y autenticaci√≥n de usuarios.

**T√≠tulo:**
Delegaci√≥n de la Gesti√≥n de Autenticaci√≥n y Credenciales

**Contexto:**
El M√≥dulo GU debe manejar el registro, inicio de sesi√≥n (*passwordless*, redes sociales), perfiles y autorizaci√≥n para los roles Comprador y Vendedor. La seguridad y el cumplimiento de est√°ndares son prioritarios.

**Alternativas:**

* **Integrar Identidad en GU:** GU almacena credenciales, emite *tokens* y valida permisos, asumiendo toda la carga de seguridad.

* **Delegar a un Identity Provider (IdP) Externo:** Usar un servicio especializado (ej. Auth0, Firebase Auth) para manejar credenciales, delegando solo la gesti√≥n del perfil de usuario a GU.

**Criterios de Elecci√≥n:**

* **Seguridad y Cumplimiento:** Protecci√≥n de credenciales y uso de est√°ndares (OAuth 2.0, MFA).

* **Eficiencia de Desarrollo:** Reducir la complejidad de implementar autenticaci√≥n y recuperaci√≥n de contrase√±as.

* **Separaci√≥n de Responsabilidades:** Aislar la l√≥gica de seguridad del perfil.

**Decisi√≥n:**
  Delegar la gesti√≥n de credenciales y *tokens* a un IdP externo, con GU gestionando el perfil de usuario y los roles.

**Sustento:**
  Delegar la seguridad a un IdP externo maximiza la **Seguridad** y eficiencia, ya que subcontrata una funcionalidad compleja. GU se enfoca en ser el servicio de perfil enriquecido de GameVault (nombre de *gamer*, *avatar*, roles) sin gestionar credenciales sensibles.

## **03: M√≥dulo: Carrito de Compras y Pedidos**

---

### **Decisi√≥n 1: Responsabilidad de la L√≥gica de C√°lculo de Precios y Creaci√≥n At√≥mica de Pedidos.**

**T√≠tulo:**
Centralizaci√≥n de la L√≥gica de *Checkout* y Consistencia Transaccional

**Contexto:**
El m√≥dulo CCP debe calcular el precio final (precio base + impuestos - descuentos) de manera precisa y crear el objeto "Pedido" de forma at√≥mica antes de interactuar con el Sistema de Pagos.

**Alternativas:**

* **L√≥gica Distribuida:** El M√≥dulo de Gesti√≥n de Usuarios calcula descuentos, el M√≥dulo de Cat√°logo de Productos da el precio base, y el CCP solo orquesta.
* **L√≥gica Centralizada en CCP:** El CCP consulta precios (del Cat√°logo) y descuentos (de Gesti√≥n de Usuarios) y aplica toda la l√≥gica de c√°lculo y reserva internamente.

**Criterios de Elecci√≥n:**

* **Consistencia Transaccional:** Asegura que todos los c√°lculos y reservas que componen un pedido se completen como una √∫nica operaci√≥n exitosa, evitando datos corruptos o inconsistentes. Se relaciona con la **Confiabilidad** del sistema.
* **Seguridad:** Implica proteger el proceso de c√°lculo de precios contra manipulaciones externas o internas que podr√≠an alterar el monto final de una compra.
* **Trazabilidad:** Se refiere a la capacidad de registrar y seguir cada paso del c√°lculo del pedido, lo cual es fundamental para auditor√≠as y para resolver disputas de clientes.

**Decisi√≥n:**
L√≥gica Centralizada en CCP.

**Sustento:**
Centralizar la l√≥gica en el CCP permite controlar la **Consistencia Transaccional** y la **Seguridad** de forma at√≥mica. El CCP se convierte en la √∫nica fuente de verdad del pedido en curso, generando un ID que referenciar√° el Pago y la Log√≠stica, simplificando la **trazabilidad**.

***

## **04: M√≥dulo: Sistema de Pagos**

---

### **Decisi√≥n 1: Responsabilidad del cumplimiento de seguridad de datos sensibles.**

**T√≠tulo:**
Estrategia para el Manejo y Custodia de Datos Financieros Sensibles

**Contexto:**
El m√≥dulo SP debe integrarse **exclusivamente con la pasarela de pagos Stripe** y gestionar la confirmaci√≥n de la transacci√≥n. Es imperativo cumplir con los est√°ndares de seguridad financiera (PCI DSS) y minimizar la exposici√≥n a datos sensibles.

**Alternativas:**

* **SP Almacena Datos:** El SP captura y almacena informaci√≥n de tarjetas de cr√©dito.
* **Delegaci√≥n con Tokenizaci√≥n:** El SP usa los *widgets* o redirecciones de Stripe para que el cliente ingrese sus datos directamente en la pasarela, y solo recibe un *token* de vuelta para procesar el pago.

**Criterios de Elecci√≥n:**

* **Seguridad:** Es la capacidad de proteger los datos financieros del cliente contra cualquier acceso no autorizado, lo cual es el atributo de calidad m√°s cr√≠tico en este m√≥dulo.
* **Cumplimiento (PCI DSS):** Es una **restricci√≥n** externa obligatoria; no cumplirla implica sanciones legales y financieras, por lo que la arquitectura debe minimizar los riesgos asociados.
* **Complejidad Operacional:** Se refiere al costo y esfuerzo de mantener la soluci√≥n. Almacenar datos de tarjetas incrementa enormemente la complejidad y los costos de operaci√≥n y mantenimiento.

**Decisi√≥n:**
Delegaci√≥n con Tokenizaci√≥n.

**Sustento:**
Delegar esta responsabilidad reduce dr√°sticamente el riesgo de **seguridad** y el alcance del **cumplimiento PCI DSS** en GameVault, ya que el m√≥dulo SP solo manejar√° *tokens* de transacci√≥n y confirmaciones de pago, nunca los datos de tarjetas de cr√©dito. Esto aplica la t√°ctica de seguridad de **"Limitar exposici√≥n"**.

## 05: M√≥dulo: Comunidad y Rese√±as
---
### Decisi√≥n 1: Separaci√≥n de la L√≥gica de Moderaci√≥n de Rese√±as de la Persistencia de Datos.

**T√≠tulo:**
Gesti√≥n de Moderaci√≥n de Contenido Generado por el Usuario

**Contexto:**
CR permite a los usuarios dejar rese√±as y valoraciones. El contenido debe pasar por moderaci√≥n (lenguaje inapropiado, *spam*, etc.) sin generar latencia para la experiencia de env√≠o del usuario.

**Alternativas:**

* **Moderaci√≥n S√≠ncrona:** El servicio CR aplica los filtros y persiste la rese√±a en estado final antes de responder al usuario. (Alta latencia, mal UX).

* **Moderaci√≥n As√≠ncrona:** El servicio CR persiste la rese√±a en estado "Pendiente" y un *Worker* (o funci√≥n *serverless*) aplica la moderaci√≥n en segundo plano.

**Criterios de Elecci√≥n:**

* **Rendimiento/UX:** Evitar latencia en la confirmaci√≥n de env√≠o de la rese√±a.

* **Robustez:** Aislar la l√≥gica pesada de procesamiento de texto/IA para el filtrado.

**Decisi√≥n:**
  Delegaci√≥n de la Moderaci√≥n a un Servicio As√≠ncrono.

**Sustento:**
  Confirmar la rese√±a al usuario inmediatamente (estado "Pendiente") mejora la **UX** y el **Rendimiento**. Aislar la l√≥gica de moderaci√≥n en un proceso as√≠ncrono garantiza la **Robustez** del microservicio principal y permite procesar contenido con herramientas especializadas (ej. ML para detecci√≥n de *spam*) sin bloquear la API web.

## 06: M√≥dulo: An√°lisis de Datos y Reportes

### Decisi√≥n 1: Fuente de Datos para la Generaci√≥n de Reportes y M√©tricas.

**T√≠tulo:**
Estrategia de Persistencia para Consultas Anal√≠ticas

**Contexto:**
ADR debe generar m√©tricas complejas (*ranking* de ventas, tendencias de b√∫squeda) sin afectar la velocidad de los microservicios transaccionales (GU, CCP). Las consultas de reportes suelen ser largas y pesadas.

**Alternativas:**

* **Consultar Bases de Datos Transaccionales (OLTP) Directamente:** Consultar CCP o GU para los reportes. (Riesgo de bloqueo y ca√≠da del rendimiento del sitio web principal).

* **Usar un Data Warehouse (DW) o Data Lake:** Almac√©n de datos optimizado para consultas complejas, alimentado por eventos as√≠ncronos.

**Criterios de Elecci√≥n:**

* **Rendimiento OLTP:** Garantizar que los reportes no afecten las transacciones de compra/venta.

* **Velocidad de Consulta Anal√≠tica:** Optimizar las consultas complejas y la agregaci√≥n de datos.

**Decisi√≥n:**
  Obtenci√≥n de datos de un Data Warehouse (DW) o Data Lake especializado, alimentado as√≠ncronamente desde los microservicios transaccionales.

**Sustento:**
  Utilizar un DW asegura que las consultas anal√≠ticas no impacten el **Rendimiento** y la **Disponibilidad** de las funcionalidades centrales (compras, cat√°logo), que son cr√≠ticas para el negocio. Los datos se replican v√≠a eventos as√≠ncronos, manteniendo el **Desacoplamiento**.

  ---

[üè† Home](../../../README.md) | [Siguiente ‚û°Ô∏è](../4.7.2/4.7.2.md)